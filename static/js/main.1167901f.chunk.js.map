{"version":3,"sources":["const.ts","components/IconButton.tsx","utils/parseExcel.ts","utils/renderPngTip.ts","utils/downloadCanvas.ts","context/GlobalContext.tsx","pages/LoadPage.tsx","resource/achievement_achieved.png","resource/achievement_show.png","components/AchievementCard.tsx","utils/index.ts","pages/ShowPage/Achievements/achievements.ts","pages/ShowPage/Achievements/renderToCanvas.ts","pages/ShowPage/Achievements/index.tsx","pages/ShowPage/CustomSider.tsx","pages/ShowPage/index.tsx","App.tsx","reportWebVitals.ts","index.tsx","utils/parseToDate.ts","components/FriendLinks.tsx","context/CacheContext.tsx","utils/v1/huffman.ts","utils/v1/utils.ts","utils/v1/compressDataItem.ts","utils/v1/compressDateNumbers.ts","utils/v1/compressDate.ts","utils/v1/index.ts","utils/compress.ts"],"names":["window","version","ISMOBILE","isMobile","navigator","any","SHOW_DATA_ALL_KEY","FONT_FAMILY","FONT_FAMILY_BOLD","COLOR","FOUR_STAR","FIVE_STAR","THREE_STAR","numberFilter","value","filterFor","toString","SCHEMA","name","type","width","hidden","filter","SCHEMA_ALL","concat","title","CHARACTER_POOLS","from","to","five","four","map","v","o","parseToDate","WEAPON_POOLS","BASE_POOL_NAME_TO_TYPE","角色活动祈愿","武器活动祈愿","新手祈愿","常驻祈愿","POOL_TYPE_TO_NAME","invert","POOL_NAME_TO_TYPE","301","302","200","100","floatButtonStyle","css","IconButton","placement","tip","icon","onClick","parseExcel","XLSX","workbook","sheetsName","SheetNames","sheets","Sheets","result","forEach","sheetName","Error","sheet","data","utils","sheet_to_json","length","formatter","template","formatters","item","星级","parseInt","count","push","保底内","index","makeFormatter","info","pool","poolType","date","时间","sortBy","flatten","Object","values","总次数","id","renderPngTip","func","key","message","loading","content","Promise","then","success","e","console","log","error","IS_XIAOMI_BROWSER","userAgent","indexOf","downloadCanvas","canvas","callback","toBlob","blob","download","toDataURL","GlobalContext","React","createContext","parsedData","page","isVertical","updateParsedData","updatePage","getInfo","clientWidth","document","body","clientHeight","useGlobalContext","useContext","GlobalContextProvider","children","useState","initInfo","useMemo","setVertical","isVerticalRef","useRef","useEffect","current","resize","nowIsVertical","addEventListener","removeEventListener","Provider","Dragger","Upload","LoadPage","onLoad","setLoading","errorMessage","setErrorMessage","loadingTip","setLoadingTip","uid","qs","parse","location","search","ignoreQueryPrefix","fetch","response","arrayBuffer","module","read","compressToHash","catch","handleUpload","useCallback","file","endsWith","reader","FileReader","onload","Uint8Array","target","onerror","readAsArrayBuffer","handleGoToMergePage","className","href","showIcon","banner","accept","multiple","beforeUpload","showUploadList","FriendLinks","mode","visible","AchievementCard","achievedTime","isAchieved","style","backgroundColor","src","AchievedPng","height","ShowPng","undefined","isWeapon","类别","defaultFormatter","formatTime","str","slice","replace","achievements","all","maxBy","keys","cur","items","名称","minBy","pools","matches","character","weapon","novice","permanent","notHitCount","hitCount","i","isHitUp","obj","find","includes","day","_day","today","resultStr","format","cache","formatByName","join","sort","a","b","waitTime","maxWaitTime","max","level","t","fromTime","endTime","waitDay","Math","floor","gacha","starFilter","limitFilter","gacha1Data","gacha10Data","reduce","acc","gacha1Count","gacha10Count","gachaFiveStarCountArr","fiveStarCount","lastIndexOf","extraInfo","isFit","list","getFourFiveStarCount","countMoreThanFourList","getWeaponCount","maxData","maxCount","sortedData","maxNum","endIndex","findIndex","names","WIDTH","getFont","size","drawText","ctx","text","letterSpace","lineHeight","props","loc","x","y","chars","split","match","font","parseFloat","save","restore","char","charWidth","measureText","draw","sx","sy","fillText","loadImage","create","cb","Array","isArray","image","Image","f","drawImage","drawOneAchievement","achievement","BORDER_MARGIN_W","BORDER_WIDTH","SIZE","HEIGHT","LEFT_PADDING","left","top","contentHeight","drawLeftZone","LEFT_ZONE_WIDTH","drawLeft","realImageWidth","right","drawValue","fillStyle","textBaseline","drawRightZone","RIGHT_ZONE_WIDTH","drawRight","PADDING_TOP","PADDING_BOTTOM","SPACE","titleHeight","drawTitle","infoHeight","drawInfo","drawContentZone","fontHeight","drawContent","fillRect","strokeStyle","lineWidth","lineJoin","strokeRect","MARGIN_W","MARGIN_H","renderToCanvas","createElement","getContext","alpha","draws","fontWidth","lineCap","centerY","beginPath","moveTo","lineTo","closePath","stroke","drawEndLine","endLineHeight","drawEnd","POOLS","CN_SHEETS","getSheetKey","sheetNames","iconCss","WrappedAchievementCard","isEditMode","isVisible","setVisible","handleHide","opacity","position","twoToneColor","Achievements","onGetData","allAchievements","useCacheMemo","allData","10","1","walk","currentDay","len","temp","achievementsFunc","setAchievements","setEditMode","handleRenderPng","resolve","reject","handleEdit","Sider","Layout","Header","GithubCorner","memo","direction","bannerColor","octoColor","_","isVerticalMenuStyle","notIsVerticalMenuStyle","CustomSider","onMenuChange","activeMenu","defaultSelectedKeys","onSelect","Item","breakpoint","theme","ShowData","lazy","default","Timeline","AnalysisChart","Content","ShowPage","getJson","clearGlobalCache","setActiveMenu","handleMenuChange","renderContent","tabs","flexDirection","CacheContext","path","fallback","MergePage","App","setError","decompressFromHash","hash","WrappedApp","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById","matchNumber","InvalidDate","Date","parts","Links","link","EllipsisStyle","Separator","GlobalCache","useCacheContext","CacheContextProvider","initValue","parentCache","contextValue","deps","useCacheState","state","setValue","createCacheContext","LEFT_CODE","RIGTH_CODE","createHuffmanUtils","hashOrMap","isHash","huffmanTree","nodes","val","splice","node","tree","formatNodeToTree","createHuffmanTreeByHash","createHuffmanTreeByMap","traversal","curPath","getHuffmanMap","encode","encodeByHuffmanTree","encodeOnce","decode","results","charAt","decodeByHuffmanTree","decodeOnce","indexRef","_nodes","depth","code","leftNodes","rightNodes","keyStrUriSafe","mapping","padStart","s","repeat","compressBinaryToEncodedURIComponent","space","formattedStr","decompressBinaryFromEncodedURIComponent","binaryStrWithSpace","spaceCount","buildHuffmanTree","bit","prefix","segs","pow","ItemType","CHARACTER","WEAPON","ItemTypeMap","Weapon3","Weapon4","Weapon5","Character4","Character5","itemTypeHuffmanUtils","treeData","extra","star","uniq","4","5","3","encodeDataItem","itemType","formatToItemType","decodeDataItem","parseFromItemType","LENGTH_TO_HUFFMAN_CODE","HUFFMAN_CODE_TO_LENGTH","lengthHuffmanUtils","encodeNumbers","numbers","log2","getLength","matchLen","ControlAction","START_DATE","decodeDate","numLength","decodeNumbers","dates","currentDate","controlActionUtils","matchOne","matchTen","changePool","poolTypeUtils","allDataItem","dataStrArr","currentPool","_dates","encodeDate","newurl","protocol","host","pathname","history","replaceState","pad2","_encodedDateStr","encodedDataStr","action","shift","dateNum","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","formatToDate"],"mappings":"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","file":"static/js/main.1167901f.chunk.js","sourcesContent":["import { PoolType } from 'types';\nimport isMobile from 'ismobilejs';\nimport parseToDate from 'utils/parseToDate';\nimport invert from 'lodash/invert';\n\n(window as any).version = '1.0.4';\n\nexport const DEVICE = isMobile(window.navigator);\n\nexport const ISMOBILE = DEVICE.any;\n\nexport const SHOW_DATA_ALL_KEY = '总览';\n\nexport const FONT_FAMILY = 'HYWenHei-65W';\nexport const FONT_FAMILY_BOLD = 'HYWenHei-85W';\n\nexport const COLOR = {\n  FOUR_STAR: '#A65FE2',\n  FIVE_STAR: '#C0713D',\n  THREE_STAR: '#4D8DF7',\n};\n// fix: canvas-datagrid have error when filter number\nconst numberFilter = function (value: number, filterFor: string | undefined) {\n  if (!filterFor) {\n    return true;\n  }\n  return value.toString() === filterFor;\n};\nexport const SCHEMA = [\n  { name: '时间', type: 'string', width: 200 },\n  { name: '编号', type: 'number', hidden: true, width: 120, filter: numberFilter },\n  { name: '名称', type: 'string', width: 130 },\n  { name: '类别', type: 'string', width: 50 },\n  { name: '星级', type: 'number', width: 50, filter: numberFilter },\n  { name: '总次数', type: 'number', hidden: true, width: 100, filter: numberFilter },\n  { name: '保底内', type: 'number', width: 80, filter: numberFilter },\n];\n\nexport const SCHEMA_ALL = (SCHEMA as any).concat({\n  name: 'pool',\n  title: '池子名称',\n  type: 'string',\n  width: 120,\n});\n\nexport const CHARACTER_POOLS: PoolType[] = [\n  {\n    from: '2020-9-28 06:00:00',\n    to: '2020-10-18 17:59:59',\n    five: ['温迪'],\n    four: ['芭芭拉', '菲谢尔', '香菱'],\n    name: '杯装之诗',\n  },\n  {\n    from: '2020-10-20 18:00:00',\n    to: '2020-11-10 14:59:59',\n    five: ['可莉'],\n    four: ['行秋', '诺艾尔', '砂糖'],\n    name: '闪焰的驻足',\n  },\n  {\n    from: '2020-11-11 06:00:00',\n    to: '2020-12-01 15:59:59',\n    five: ['达达利亚'],\n    four: ['迪奥娜', '北斗', '凝光'],\n    name: '暂别冬都',\n  },\n  {\n    from: '2020-12-01 18:00:00',\n    to: '2020-12-22 14:59:59',\n    five: ['钟离'],\n    four: ['辛焱', '雷泽', '重云'],\n    name: '陵薮市朝',\n  },\n  {\n    from: '2020-12-23 06:00:00',\n    to: '2021-01-12 15:59:59',\n    five: ['阿贝多'],\n    four: ['菲谢尔', '砂糖', '班尼特'],\n    name: '深秘之息',\n  },\n  {\n    from: '2021-01-12 18:00:00',\n    to: '2021-02-02 14:59:59',\n    five: ['甘雨'],\n    four: ['香菱', '行秋', '诺艾尔'],\n    name: '浮生孰来',\n  },\n  {\n    from: '2021-02-03 06:00:00',\n    to: '2021-02-17 15:59:59',\n    five: ['魈'],\n    four: ['迪奥娜', '北斗', '辛焱'],\n    name: '烟火之邀',\n  },\n  {\n    from: '2021-02-17 18:00:00',\n    to: '2021-03-02 15:59:59',\n    five: ['刻晴'],\n    four: ['凝光', '班尼特', '芭芭拉'],\n    name: '鱼龙灯昼',\n  },\n  {\n    from: '2021-03-02 18:00:00',\n    to: '2021-03-16 14:59:59',\n    five: ['胡桃'],\n    four: ['行秋', '香菱', '重云'],\n    name: '赤团开时',\n  },\n  {\n    from: '2021-03-17 06:00:00',\n    to: '2021-04-06 15:59:59',\n    five: ['温迪'],\n    four: ['砂糖', '雷泽', '诺艾尔'],\n    name: '杯装之诗',\n  },\n  {\n    from: '2021-04-06 18:00:00',\n    to: '2021-04-27 14:59:59',\n    five: ['达达利亚'],\n    four: ['罗莎莉亚', '芭芭拉', '菲谢尔'],\n    name: '暂别冬都',\n  },\n  {\n    from: '2021-04-28 06:00:00',\n    to: '2021-05-18 17:59:59',\n    five: ['钟离'],\n    four: ['烟绯', '诺艾尔', '迪奥娜'],\n    name: '陵薮市朝',\n  },\n  {\n    from: '2021-05-18 18:00:00',\n    to: '2021-06-08 14:59:59',\n    five: ['优菈'],\n    four: ['辛焱', '行秋', '北斗'],\n    name: '浪沫的旋舞',\n  },\n  {\n    from: '2021-06-09 06:00:00',\n    to: '2021-06-29 17:59:59',\n    five: ['可莉'],\n    four: ['芭芭拉', '砂糖', '菲谢尔'],\n    name: '逃跑的太阳',\n  },\n  {\n    from: '2021-06-29 18:00:00',\n    to: '2021-07-20 14:59:59',\n    five: ['枫原万叶'],\n    four: ['罗莎莉亚', '班尼特', '雷泽'],\n    name: '红叶逐荒波',\n  },\n  {\n    from: '2021-07-21 06:00:00',\n    to: '2021-08-10 17:59:59',\n    five: ['神里绫华'],\n    four: ['凝光', '重云', '烟绯'],\n    name: '白鹭之庭',\n  },\n  {\n    from: '2021-08-10 18:00:00',\n    to: '2021-08-31 14:59:59',\n    five: ['宵宫'],\n    four: ['早柚', '迪奥娜', '辛焱'],\n    name: '焰色天河',\n  },\n  {\n    from: '2021-09-01 06:00:00',\n    to: '2021-09-21 17:59:59',\n    five: ['雷电将军'],\n    four: ['九条裟罗', '香菱', '砂糖'],\n    name: '影寂天下人',\n  },\n  {\n    from: '2021-09-21 18:00:00',\n    to: '2021-10-12 14:59:59',\n    five: ['珊瑚宫心海'],\n    four: ['罗莎莉亚', '北斗', '行秋'],\n    name: '浮岳虹珠',\n  },\n].map((v) => {\n  const o: PoolType = v as any;\n  o.from = +parseToDate(v.from);\n  o.to = +parseToDate(v.to);\n  o.type = 'character';\n  return o;\n});\nexport const WEAPON_POOLS: PoolType[] = [\n  {\n    from: '2020-10-20 18:00:00',\n    to: '2020-11-10 14:59:59',\n    five: ['四风原典', '狼的末路'],\n    four: ['祭礼剑', '祭礼大剑', '祭礼残章', '祭礼弓', '匣里灭辰'],\n    name: '神铸赋形',\n  },\n  {\n    from: '2020-11-11 06:00:00',\n    to: '2020-12-01 15:59:59',\n    five: ['天空之翼', '尘世之锁'],\n    four: ['笛剑', '雨裁', '昭心', '弓藏', '西风长枪'],\n    name: '神铸赋形',\n  },\n  {\n    from: '2020-12-01 18:00:00',\n    to: ' 2020-12-22 14:59:59',\n    five: ['贯虹之槊', '无工之剑'],\n    four: ['匣里龙吟', '钟剑', '西风秘典', '西风猎弓', '匣里灭辰'],\n    name: '神铸赋形',\n  },\n  {\n    from: '2020-12-23 06:00:00',\n    to: '2021-01-12 15:59:59',\n    five: ['斫峰之刃', '天空之卷'],\n    four: ['西风剑', '西风大剑', '西风长枪', '祭礼残章', '绝弦'],\n    name: '神铸赋形',\n  },\n\n  {\n    from: '2021-01-12 18:00:00',\n    to: '2021-02-02 14:59:59',\n    five: ['阿莫斯之弓', '天空之傲'],\n    four: ['祭礼剑', '钟剑', '匣里灭辰', '昭心', '西风猎弓'],\n    name: '神铸赋形',\n  },\n  {\n    from: '2021-02-03 06:00:00',\n    to: '2021-02-23 15:59:59',\n    five: ['磐岩结绿', '和璞鸢'],\n    four: ['笛剑', '祭礼大剑', '弓藏', '昭心', '西风长枪'],\n    name: '神铸赋形',\n  },\n  {\n    from: '2021-02-23 18:00:00',\n    to: '2021-03-16 14:59:59',\n    five: ['护摩之杖', '狼的末路'],\n    four: ['匣里龙吟', '千岩古剑', '祭礼弓', '流浪乐章', '千岩长枪'],\n    name: '神铸赋形',\n  },\n  {\n    from: '2021-03-17 06:00:00',\n    to: '2021-04-06 15:59:59',\n    five: ['终末嗟叹之诗', '天空之刃'],\n    four: ['暗巷闪光', '西风大剑', '西风猎弓', '暗巷的酒与诗', '匣里灭辰'],\n    name: '神铸赋形',\n  },\n  {\n    from: '2021-04-06 18:00:00',\n    to: '2021-04-27 14:59:59',\n    five: ['天空之翼', '四风原典'],\n    four: ['西风剑', '祭礼大剑', '暗巷猎手', '西风秘典', '西风长枪'],\n    name: '神铸赋形',\n  },\n  {\n    from: '2021-04-28 06:00:00',\n    to: '2021-05-18 17:59:59',\n    five: ['斫峰之刃', '尘世之锁'],\n    four: ['笛剑', '千岩古剑', '祭礼弓', '昭心', '千岩长枪'],\n    name: '神铸赋形',\n  },\n  {\n    from: '2021-05-18 18:00:00',\n    to: '2021-06-08 14:59:59',\n    five: ['松籁响起之时', '风鹰剑'],\n    four: ['祭礼剑', '雨裁', '匣里灭辰', '祭礼残章', '弓藏'],\n    name: '神铸赋形',\n  },\n  {\n    from: '2021-06-09 06:00:00',\n    to: '2021-06-29 17:59:59',\n    five: ['天空之傲', '四风原典'],\n    four: ['匣里龙吟', '钟剑', '西风长枪', '流浪乐章', '幽夜华尔兹'],\n    name: '神铸赋形',\n  },\n  {\n    from: '2021-06-29 18:00:00',\n    to: '2021-07-20 14:59:59',\n    five: ['苍古自由之翼', '天空之卷'],\n    four: ['暗巷闪光', '西风大剑', '匣里灭辰', '暗巷的酒与诗', '暗巷猎手'],\n    name: '神铸赋形',\n  },\n  {\n    from: '2021-07-21 06:00:00',\n    to: '2021-08-10 17:59:59',\n    five: ['雾切之回光', '天空之脊'],\n    four: ['西风剑', '祭礼大剑', '西风长枪', '西风秘典', '绝弦'],\n    name: '神铸赋形',\n  },\n  {\n    from: '2021-08-10 18:00:00',\n    to: '2021-08-31 14:59:59',\n    five: ['飞雷之弦振', '天空之刃'],\n    four: ['祭礼剑', '雨裁', '匣里灭辰', '祭礼残章', '西风猎弓'],\n    name: '神铸赋形',\n  },\n  {\n    from: '2021-09-01 06:00:00',\n    to: '2021-09-21 17:59:59',\n    five: ['薙草之稻光', '无工之剑'],\n    four: ['匣里龙吟', '钟剑', '西风长枪', '流浪乐章', '祭礼弓'],\n    name: '神铸赋形',\n  },\n  {\n    from: '2021-09-21 18:00:00',\n    to: '2021-10-12 14:59:59',\n    five: ['不灭月华', '磐岩结绿'],\n    four: ['笛剑', '西风大剑', '匣里灭辰', '西风秘典', '绝弦'],\n    name: '神铸赋形',\n  },\n].map((v) => {\n  const o: PoolType = v as any;\n  o.from = +parseToDate(v.from);\n  o.to = +parseToDate(v.to);\n  o.type = 'weapon';\n  return o;\n});\n\nexport const BASE_POOL_NAME_TO_TYPE = {\n  角色活动祈愿: 'character',\n  武器活动祈愿: 'weapon',\n  新手祈愿: 'novice',\n  常驻祈愿: 'permanent',\n};\nexport const POOL_TYPE_TO_NAME = invert(BASE_POOL_NAME_TO_TYPE);\n\nexport const POOL_NAME_TO_TYPE = {\n  ...BASE_POOL_NAME_TO_TYPE,\n  301: 'character',\n  302: 'weapon',\n  200: 'permanent',\n  100: 'novice',\n};\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport React, { FC } from 'react';\nimport { Button, ButtonProps, Tooltip, TooltipProps } from 'antd';\n\ntype IconButtonProps = {\n  placement?: TooltipProps['placement'];\n  tip?: TooltipProps['title'];\n  icon: ButtonProps['icon'];\n  onClick?: ButtonProps['onClick'];\n};\nconst floatButtonStyle = css`\n  width: 40px;\n  height: 40px;\n  background: #fff;\n  color: #8590a6;\n  font-size: 20px;\n  box-shadow: 0 1px 3px rgb(18 18 18 / 10%);\n  margin: 5px;\n  border-color: transparent;\n  border-radius: 4px;\n  &:active {\n    background: #fff;\n    color: #8590a6;\n  }\n  &:focus {\n    background: #fff;\n    color: #8590a6;\n  }\n  &:hover {\n    background: #d3d3d3;\n  }\n`;\n\nexport const IconButton: FC<IconButtonProps> = function ({ placement, tip, icon, onClick }) {\n  return (\n    <Tooltip placement={placement} title={tip}>\n      <Button icon={icon} onClick={onClick} css={floatButtonStyle} type='text' />\n    </Tooltip>\n  );\n};\n","/**\n * 解析Excel\n */\nimport { Data, DataItem } from 'types';\nimport XLSXNameSpace, { WorkBook } from 'xlsx/types';\nimport flatten from 'lodash/flatten';\nimport sortBy from 'lodash/sortBy';\nimport parseToDate from './parseToDate';\nimport { POOL_NAME_TO_TYPE, POOL_TYPE_TO_NAME } from 'const';\n\nexport type ExcelParsedObject = {\n  character: DataItem[];\n  weapon: DataItem[];\n  novice: DataItem[];\n  permanent: DataItem[];\n};\n\nfunction makeFormatter(template: DataItem) {\n  const formatters: Array<(item: DataItem, index?: number) => void> = [\n    (item) => {\n      if (typeof item.星级 !== 'number') item.星级 = parseInt(item.星级);\n    },\n  ];\n  // 抽卡记录合并可能会导致保底内数据重置，在此不信任\"保底内\"数据，重新生成\n  let count = 1;\n  formatters.push((item) => {\n    item.保底内 = count++;\n    if (item.星级 === 5) count = 1;\n  });\n  return (item: DataItem, index: number) => {\n    formatters.forEach((formatter) => formatter(item, index));\n    return item;\n  };\n}\n\nexport default function parseExcel(XLSX: typeof XLSXNameSpace, workbook: WorkBook) {\n  const sheetsName = workbook.SheetNames;\n  const sheets = workbook.Sheets;\n  const result = {} as ExcelParsedObject;\n  sheetsName.forEach((sheetName: string) => {\n    if (sheetName in POOL_NAME_TO_TYPE) {\n      const type = (POOL_NAME_TO_TYPE as any)[sheetName];\n      const sheet = sheets[sheetName];\n      let data = XLSX.utils.sheet_to_json(sheet) as DataItem[];\n      // 只信任 抽卡数据里的 名称，日期，星级，其他数据按照时间顺序重新生成\n      if (data.length !== 0) {\n        const formatter = makeFormatter(data[0]);\n        data.forEach((info, index) => {\n          info.pool = (POOL_TYPE_TO_NAME as any)[type];\n          info.poolType = type;\n          info.date = +parseToDate(info.时间);\n        });\n        data = sortBy(data, (item) => item.date);\n        data.forEach(formatter);\n      }\n      (result as any)[type] = data;\n    } else throw new Error(`cannot parse sheetName ${sheetName}`);\n  });\n  // 不信任\"总次数\"数据，重新生成\n  sortBy(flatten(Object.values(result)), (item) => item.date).forEach((item, index) => {\n    item.总次数 = index + 1;\n  });\n  return result;\n}\n","import { message } from 'antd';\n\nlet id = 0;\n\nexport default function renderPngTip(func: (resolve: () => void, reject: () => void) => void) {\n  const key = `${id++}`;\n  message.loading({\n    content: '生成图片中...',\n    key,\n  });\n  const loading = new Promise(func as any);\n  loading.then(\n    () => {\n      message.success({\n        content: '生成图片成功',\n        key,\n      });\n    },\n    (e: any) => {\n      console.log(e);\n      message.error({\n        content: '生成图片失败，请重试或更换浏览器',\n        key,\n      });\n    },\n  );\n}\n","// @ts-ignore\nimport * as download from 'downloadjs';\n/**\n * 下载canvas为图片，手机部分浏览器不支持 createObjectUrl 等\n */\nconst userAgent = window.navigator.userAgent;\nconst IS_XIAOMI_BROWSER = userAgent.indexOf('MiuiBrowser') > -1;\nexport default function downloadCanvas(\n  canvas: HTMLCanvasElement,\n  name: string,\n  callback?: () => void,\n) {\n  if (IS_XIAOMI_BROWSER) {\n    canvas.toBlob((blob) => {\n      download(blob, name);\n      callback && callback();\n    });\n  } else {\n    download(canvas.toDataURL(), name);\n    callback && callback();\n  }\n}\n","import React, { useEffect, useMemo, useRef, useState, FC, useContext } from 'react';\nimport { ExcelParsedObject } from 'utils/parseExcel';\nimport { WorkBook } from 'xlsx/types';\n\ntype GlobalContextType = {\n  page: string;\n  parsedData: ExcelParsedObject | null;\n  isVertical: boolean;\n  updatePage: (page: string) => void;\n  updateParsedData: (parsedData: ExcelParsedObject) => void;\n};\n\nexport const GlobalContext = React.createContext<GlobalContextType>({\n  parsedData: null,\n  page: '',\n  isVertical: false,\n  updateParsedData: (() => {}) as any,\n  updatePage: (() => {}) as any,\n});\n\n// 获取尺寸信息\nfunction getInfo() {\n  const clientWidth = document.body.clientWidth;\n  const clientHeight = document.body.clientHeight;\n  return {\n    clientWidth,\n    clientHeight,\n    isVertical: clientHeight > clientWidth,\n  };\n}\nexport const useGlobalContext = function () {\n  return useContext(GlobalContext);\n};\n\nexport const GlobalContextProvider: FC<{}> = function ({ children }) {\n  const [parsedData, updateParsedData] = useState<ExcelParsedObject | null>(null);\n  const [page, updatePage] = useState<string>('');\n  const initInfo = useMemo(() => getInfo(), []);\n  const [isVertical, setVertical] = useState(initInfo.isVertical);\n  const isVerticalRef = useRef<boolean>(isVertical);\n  useEffect(() => {\n    isVerticalRef.current = isVertical;\n  }, [isVertical]);\n  useEffect(() => {\n    function resize() {\n      const { isVertical: nowIsVertical } = getInfo();\n      if (nowIsVertical !== isVerticalRef.current) setVertical(nowIsVertical);\n    }\n    window.addEventListener('resize', resize);\n    return () => {\n      window.removeEventListener('resize', resize);\n    };\n  }, []);\n  const value = useMemo(() => {\n    return {\n      parsedData,\n      updateParsedData,\n      page,\n      updatePage,\n      isVertical,\n    };\n  }, [isVertical, parsedData, page]);\n  return <GlobalContext.Provider value={value}>{children}</GlobalContext.Provider>;\n};\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { FC, useCallback, useState } from 'react';\nimport { Button, Upload, Alert, Spin } from 'antd';\nimport InboxOutlined from '@ant-design/icons/InboxOutlined';\nimport { RcFile } from 'antd/lib/upload';\nimport { useGlobalContext } from 'context/GlobalContext';\nimport XLSXNameSpace from 'xlsx/types';\nimport { FriendLinks } from 'components/FriendLinks';\nimport parseExcel from 'utils/parseExcel';\nimport { compressToHash } from 'utils/compress';\nimport qs from 'qs';\n\nconst { Dragger } = Upload;\ntype LoadPageProps = {\n  onLoad?: () => void;\n};\n// 预加载\n// @ts-ignore\nimport('xlsx/dist/xlsx.mini.min.js');\n\nexport const LoadPage: FC<LoadPageProps> = function ({ onLoad }) {\n  const [loading, setLoading] = useState<Boolean>(false);\n  const [errorMessage, setErrorMessage] = useState<String | null>(null);\n  const [loadingTip, setLoadingTip] = useState('加载中...');\n  const { updateParsedData, updatePage } = useGlobalContext();\n  const params = qs.parse(document.location.search, {ignoreQueryPrefix: true})\n  const uid = params.uid\n  //const host = \"https://www.lolisaigao.club\"\n  const host = \"https://212.64.70.27\"\n  if (uid) {\n    fetch(`${host}/genshin/gachalog/xlsx/${uid}`)\n      .then(response => response.arrayBuffer())\n      .then(data => {\n        setLoadingTip('xlsx解析文件加载中...');\n        // @ts-ignore\n        import('xlsx/dist/xlsx.mini.min.js')\n          .then((module) => {\n            try {\n              const XLSX: typeof XLSXNameSpace = module;\n              // const data = new Uint8Array((e.target as FileReader).result as any);\n              const workbook = XLSX.read(data, { type: 'array' });\n              const parsedData = parseExcel(XLSX, workbook);\n              compressToHash(parsedData);\n              updateParsedData(parsedData);\n            } catch (e: any) {\n              setErrorMessage(e.message);\n            }\n          })\n          .catch(() => {\n            setErrorMessage('XLSX解析文件加载失败');\n            setLoading(false);\n          });\n      })\n      .catch(e => {\n        setErrorMessage('数据获取失败');\n        setLoading(false);\n        console.log('错误:', e)\n      })\n  }\n  const handleUpload = useCallback((file: RcFile) => {\n    if (!file.name.endsWith('.xlsx')) {\n      setErrorMessage('文件类型错误，请上传xlsx文件');\n      return false;\n    }\n    setLoading(true);\n    const reader = new FileReader();\n    reader.onload = function (e: ProgressEvent<FileReader>) {\n      setLoadingTip('xlsx解析文件加载中...');\n      // @ts-ignore\n      import('xlsx/dist/xlsx.mini.min.js')\n        .then((module) => {\n          try {\n            const XLSX: typeof XLSXNameSpace = module;\n            const data = new Uint8Array((e.target as FileReader).result as any);\n            const workbook = XLSX.read(data, { type: 'array' });\n            const parsedData = parseExcel(XLSX, workbook);\n            compressToHash(parsedData);\n            updateParsedData(parsedData);\n          } catch (e: any) {\n            setErrorMessage(e.message);\n          }\n        })\n        .catch(() => {\n          setErrorMessage('XLSX解析文件加载失败，请重新上传');\n        });\n    };\n    reader.onerror = function (e: ProgressEvent<FileReader>) {\n      setErrorMessage('解析文件失败, 请重新上传');\n      setLoading(false);\n    };\n    reader.readAsArrayBuffer(file);\n    return false;\n  }, []);\n  const handleGoToMergePage = useCallback(() => {\n    updatePage('merge');\n  }, []);\n  return (\n    <div\n      css={css`\n        overflow: auto;\n      `}\n    >\n      <div\n        className='ant-alert-info'\n        css={css`\n          width: 100%;\n          display: flex;\n          justify-content: center;\n          border: none;\n          margin: 20px 0;\n        `}\n      >\n        <Alert\n          message={\n            <>\n              <div>\n                不知道如何获取抽卡记录导出文件？\n                <a href='https://ngabbs.com/read.php?tid=25657464' target='_blank'>\n                  <Button type='link'>请点击这里</Button>\n                </a>\n              </div>\n              <div>\n                合并多个抽卡记录文件\n                <Button type='link' onClick={handleGoToMergePage}>\n                  请点击这里\n                </Button>\n              </div>\n            </>\n          }\n          type='info'\n          showIcon={false}\n          banner\n        />\n      </div>\n      <Dragger\n        name='file'\n        accept='application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, .xlsx'\n        multiple={false}\n        beforeUpload={handleUpload}\n        showUploadList={false}\n        css={css`\n          width: 100%;\n          max-width: 600px;\n          margin: 0 auto;\n          padding: 40px;\n        `}\n      >\n        {errorMessage && <Alert message={errorMessage} type='error' />}\n        <p className='ant-upload-drag-icon'>\n          {loading ? <Spin tip={loadingTip} /> : <InboxOutlined />}\n        </p>\n        {uid ? <Spin tip=\"正在从服务器下载数据 请稍等...\"/> : <InboxOutlined/>}\n        <p className='ant-upload-text'>点击选择抽卡记录导出文件或将文件拖拽到此区域</p>\n        <p className='ant-upload-text'>( 注：文件的后缀应为.xlsx )</p>\n      </Dragger>\n      <Alert\n        css={css`\n          margin: 20px auto;\n          width: 100%;\n          max-width: 600px;\n        `}\n        message={\n          <div>\n            此网站是静态网站，你的文件不会被上传到网站后台，具体代码请查看\n            <Button\n              type='link'\n              href='https://github.com/voderl/genshin-gacha-analyzer'\n              target='_blank'\n            >\n              github链接\n            </Button>\n          </div>\n        }\n        type='warning'\n        showIcon\n      />\n      <FriendLinks mode='bottom' visible />\n    </div>\n  );\n};\n","export default __webpack_public_path__ + \"static/media/achievement_achieved.49d0cc2e.png\";","export default __webpack_public_path__ + \"static/media/achievement_show.b270d366.png\";","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport React, { FC, useCallback, useMemo } from 'react';\nimport UnAchievedPng from 'resource/achievement_unachieve.png';\nimport AchievedPng from 'resource/achievement_achieved.png';\nimport ShowPng from 'resource/achievement_show.png';\n\nexport type AchievementCardProps = {\n  title: string;\n  info: string;\n  value?: string | number;\n  achievedTime?: string;\n};\n\nexport const AchievementCard: FC<AchievementCardProps> = function ({\n  title,\n  info,\n  value,\n  achievedTime,\n  children,\n}) {\n  const isAchieved = !!achievedTime;\n  return (\n    <div\n      style={{\n        // backgroundColor: isAchieved ? '#ebe2d8' : '#f5f1eb',\n        backgroundColor: '#ebe2d8',\n      }}\n      css={css`\n        position: relative;\n        width: 100%;\n        max-width: 800px;\n        min-height: 100px;\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        border: 2px solid #e0d6cb;\n        color: #bca895;\n        color: #988b81;\n        font-size: 16px;\n        margin: 4px auto;\n      `}\n    >\n      {children}\n      <img\n        src={/* isAchieved ? AchievedPng : UnAchievedPng */ AchievedPng}\n        width='104'\n        height='104'\n        css={css`\n          margin: 0 16px;\n          width: 80px;\n          height: 80px;\n        `}\n      />\n      <div\n        css={css`\n          flex: 1 1;\n          padding: 12px 0;\n          p {\n            margin-bottom: 4px;\n          }\n        `}\n      >\n        <p\n          css={css`\n            color: #585757;\n            font-size: 20px;\n          `}\n        >\n          {title}\n        </p>\n        <p>{info}</p>\n      </div>\n      {isAchieved ? (\n        <div\n          css={css`\n            width: 128px;\n            margin-left: 12px;\n            height: 96px;\n            background: url(${ShowPng}) no-repeat right/cover;\n            display: flex;\n            flex-direction: column;\n            justify-content: flex-end;\n            align-items: center;\n          `}\n        >\n          <span\n            css={css`\n              font-size: 20px;\n            `}\n          >\n            {value === undefined ? '达成' : value}\n          </span>\n          <span\n            css={css`\n              padding: 8px 0 0px;\n              font-size: 15px;\n            `}\n          >\n            {achievedTime}\n          </span>\n        </div>\n      ) : (\n        value !== undefined && (\n          <div\n            css={css`\n              width: 128px;\n              height: 96px;\n              background-color: #ebe2d8;\n              text-align: center;\n            `}\n          >\n            <span\n              css={css`\n                line-height: 96px;\n                font-size: 20px;\n              `}\n            >\n              {value}\n            </span>\n          </div>\n        )\n      )}\n    </div>\n  );\n};\n","import { DataItem } from 'types';\n\nexport const isWeapon = (item: DataItem) => item.类别 === '武器';\n","import { Data, DataItem, Source } from 'types';\nimport maxBy from 'lodash/maxBy';\nimport minBy from 'lodash/minBy';\nimport max from 'lodash/max';\nimport { AchievementCardProps } from 'components/AchievementCard';\nimport { CHARACTER_POOLS } from 'const';\nimport { isWeapon } from 'utils';\n\n/**\n * 成就计算相互独立，每个为一个函数，传入给定的参数，返回规定的格式。具体参数和返回格式见下面。\n */\ntype Show = {\n  单个数据类型: DataItem;\n  函数返回类型: AchievementCardProps | AchievementCardProps[]; // 返回flase， undefined表示没有\n  传入参数展示: {\n    // 在开发模式下传入参数会在控制台输出\n    character: {\n      5: {\n        七七: {\n          data: DataItem[]; // 七七的所有抽卡记录\n        };\n      };\n      4: '同上';\n    };\n    weapon: {\n      5: {\n        狼的末路: {\n          data: DataItem[]; // 狼的末路的所有抽卡记录\n        };\n      };\n      4: '同上';\n      3: '同上';\n    };\n    all: '结构同上，包含角色与武器';\n    gacha: {\n      10: [DataItem[]]; // 十抽数据的数组,\n      1: [DataItem]; // 单抽数据的数组\n    };\n    data: DataItem[]; // 全部抽卡记录源数据\n    day: {\n      // 不同天数的抽卡记录\n      '2020-9-16': {\n        data: DataItem[];\n      };\n    };\n    pools: {\n      character: DataItem[]; // 人物Up池所有抽卡\n      weapon: DataItem[]; // 武器up池数据\n      novice: DataItem[]; //  新手池数据\n      permanent: DataItem[]; // 常驻池数据\n    };\n  };\n};\n\nfunction toPercent(point: number) {\n  return Number(point * 100).toFixed(2) + '%';\n}\nconst defaultFormatter = (name: string, count: number) =>\n  `「${name}」` + (count === 1 ? '' : `×${count}`);\nfunction formatByName(data: Data, format = defaultFormatter) {\n  const cache: any = {};\n  data.forEach((item) => {\n    if (item.名称 in cache) cache[item.名称] += 1;\n    else cache[item.名称] = 1;\n  });\n  return Object.keys(cache).map((key) => format(key, cache[key]));\n}\nconst formatTime = (str: string) => str.slice(0, 10).replace(/-/g, '/');\nconst calculateTime = (t: number) => {\n  var d = Math.floor(t / 1000 / 60 / 60 / 24);\n  var h = Math.floor((t / 1000 / 60 / 60) % 24);\n  return d + ' 天' + h + ' 时';\n};\nexport const achievements: Array<(\n  data: Source,\n) => AchievementCardProps | AchievementCardProps[] | false | void> = [\n  function maxGacha({ all }: Source) {\n    const name = maxBy(Object.keys(all[5]), (cur) => {\n      const items = all[5][cur].data;\n      return (maxBy(items, (item) => item.保底内) as DataItem).保底内;\n    });\n    if (!name) return false;\n    const item = maxBy(all[5][name].data, (item) => item.保底内);\n    if (!item) return false;\n    if (item.保底内 < 80) return;\n    let info = '';\n    if (item.保底内 >= 84) {\n      info = ', 你竟是' + ['百', '千', '万', '十万', '百万'][item.保底内 - 84] + '里挑一的非酋!';\n    }\n    return {\n      title: '「原来非酋竟是我自己」',\n      info: `抽了 ${item.保底内} 次才最终抽到了「${item.名称}」${info}`,\n      achievedTime: item.时间,\n      value: item.保底内,\n    };\n  },\n  function minGacha({ all }: Source) {\n    const name = minBy(Object.keys(all[5]), (cur) => {\n      const items = all[5][cur].data;\n      return (minBy(items, (item) => item.保底内) as DataItem).保底内;\n    });\n    if (!name) return false;\n    const item = minBy(all[5][name].data, (item) => item.保底内);\n    if (!item) return false;\n    const count = item.保底内;\n    if (count > 30) return;\n    let info = '';\n    if (count <= 5) info = `, 你的欧气无人能敌!`;\n    return {\n      title: '「欧皇时刻」',\n      info: `只抽了 ${item.保底内} 次就抽到了「${item.名称}」${info}`,\n      achievedTime: item.时间,\n      value: item.保底内,\n    };\n  },\n  // 不碰某些池子\n  function ({ pools }) {\n    const matches = [];\n    if (pools.character.length === 0)\n      matches.push({\n        title: '「角色Up池? 不稀罕!」',\n        info: '没有在「角色活动祈愿」中进行抽卡',\n      });\n    if (pools.weapon.length === 0)\n      matches.push({\n        title: '「武器池？能吃吗？」',\n        info: '没有在「武器活动祈愿」中进行抽卡',\n      });\n    if (pools.novice.length === 0)\n      matches.push({\n        title: '「永远的新手」',\n        info: '没有在「新手祈愿」中进行抽卡',\n      });\n    if (pools.permanent.length === 0)\n      matches.push({\n        title: '「传说中的毒池」',\n        info: '没有在「常驻祈愿」中进行抽卡',\n      });\n    return matches;\n  },\n  // 人物Up池歪的比例\n  function upWrong({ pools }) {\n    const data = pools.character.filter((data) => data.星级 === 5);\n    if (data.length === 0) return;\n    // 是否是Up角色\n    function isHitUp(item: DataItem) {\n      const date = item.date;\n      const pool = CHARACTER_POOLS.find((pool) => date >= pool.from && date <= pool.to);\n      if (!pool) return false;\n      return pool.five.includes(item.名称);\n    }\n    let notHitCount = 0,\n      hitCount = 0;\n    for (let i = 0; i < data.length; i++) {\n      if (isHitUp(data[i])) {\n        hitCount++;\n      } else {\n        i++;\n        notHitCount++;\n      }\n    }\n    const obj = {\n      value: `${notHitCount} / ${hitCount + notHitCount}`,\n      achievedTime: '小保底歪的概率',\n    };\n    if (notHitCount === 0)\n      return {\n        title: '「不倒翁」',\n        info: `在「角色活动祈愿」中抽中的五星角色均为当期Up角色`,\n        ...obj,\n      };\n    if (hitCount > notHitCount)\n      return {\n        title: '「晴时总比雨时多」',\n        info: `在「角色活动祈愿」中，小保底偏向于抽中当期Up角色`,\n        ...obj,\n      };\n    if (hitCount === notHitCount)\n      return {\n        title: '「晴雨各半」',\n        info: `在「角色活动祈愿」中小保底歪与不歪持平`,\n        ...obj,\n      };\n    return {\n      title: '「雨时偏比晴时多」',\n      info: `在「角色活动祈愿」中，小保底偏向于没有抽中当期Up角色`,\n      ...obj,\n    };\n  },\n  function maxGachaDay({ day, data }) {\n    const _day = maxBy(Object.values(day), (today) => today.data.length);\n    if (!_day) return false;\n    const result = _day.data.filter((item) => item.星级 === 5);\n    if (result.length === 0)\n      return {\n        // from nga @carry_tu (https://ngabbs.com/nuke.php?func=ucp&uid=41767591)\n        title: '「最黑暗的一天」', // 最多抽数的一天且并没有出黄\n        info: `在${formatTime(_day.data[0].时间)}这一天，你共抽取了 ${\n          _day.data.length\n        } 次，然而并没有出黄，是抽卡记录中最黑暗的一天`,\n        achievedTime: _day.data[0].时间,\n        value: _day.data.length,\n      };\n    const resultStr = `在抽到${formatByName(result).join('、')}时，你有没有很开心呢？`;\n    return {\n      title: '「豪掷千金」',\n      info: `在${formatTime(_day.data[0].时间)}这一天，你共抽取了 ${\n        _day.data.length\n      } 次。${resultStr}`,\n      achievedTime: _day.data[0].时间,\n      value: _day.data.length,\n    };\n  },\n  function CangshuExpert({ pools }) {\n    const { character, weapon } = pools;\n    const data = character\n      .concat(weapon)\n      .sort((a, b) => (a.date === b.date ? a.总次数 - b.总次数 : a.date - b.date));\n    const waitTime = data.slice(1).map((v, index) => v.date - data[index].date);\n    if (waitTime.length === 0) return;\n    const maxWaitTime = max(waitTime as Array<number>);\n    if (!maxWaitTime) return;\n    const index = waitTime.indexOf(maxWaitTime);\n    const fromTime = data[index].时间,\n      endTime = data[index + 1].时间;\n    const waitDay = maxWaitTime / 3600 / 24 / 1000;\n    let level, info;\n    if (waitDay <= 15) {\n      level = '随缘';\n      info = '是一只不太合格的仓鼠呢~';\n    } else if (waitDay <= 30) {\n      level = '合格';\n      info = '你已经是一只合格的仓鼠了';\n    } else if (waitDay <= 60) {\n      level = '专家';\n      info = '作为仓鼠，你就是专家!';\n    } else {\n      level = '大师';\n      info = '您的传说受到了众仓鼠的景仰!';\n    }\n    return {\n      title: `「${level}仓鼠」`,\n      info: `从${formatTime(fromTime)}到${formatTime(\n        endTime,\n      )}没有使用「纠缠之缘」进行抽卡。${info}`,\n      value: calculateTime(maxWaitTime),\n      achievedTime: '持续时间',\n    };\n  },\n  function oneGachaGetFiveStar({ gacha }) {\n    const countLimit = 40; // 限制抽数，避免你看要保底了就单抽，而导致假的单抽出奇迹\n    const percentLimit = 0.3;\n    const starFilter = (item: DataItem) => item.星级 === 5;\n    const limitFilter = (item: DataItem) => item.保底内 <= countLimit;\n    const gacha1Data = gacha[1].filter(limitFilter); // 所有满足条件的单抽\n    const gacha10Data = gacha[10].reduce((acc, cur) => {\n      return acc.concat(cur.data.filter(limitFilter));\n    }, [] as DataItem[]);\n    const gacha1Count = gacha1Data.filter(starFilter).length;\n    const gacha10Count = gacha10Data.filter(starFilter).length;\n    if (gacha1Count === 0 && gacha10Count === 0) return;\n    let info = [];\n    if (gacha1Count) info.push(`通过单抽获取的数目为 ${gacha1Count}`);\n    if (gacha10Count) info.push(`通过十连获取的数目为 ${gacha10Count}`);\n    const data = {\n      info: `在 ${countLimit} 抽内获取 5 星共计 ${gacha1Count + gacha10Count} 次，其中${info.join(\n        '，',\n      )}`,\n    };\n    if (gacha1Count / gacha10Count < percentLimit) {\n      return {\n        title: '「十连出奇迹(√)」',\n        ...data,\n      };\n    }\n    if (gacha10Count / gacha1Count < percentLimit) {\n      return {\n        title: '「单抽出奇迹！」',\n        ...data,\n      };\n    }\n    return {\n      title: '「单抽出奇迹？」',\n      ...data,\n    };\n  },\n  function gacha10Data({ gacha }) {\n    const gachaFiveStarCountArr = gacha[10].map(\n      (item) => item.data.filter((v) => v.星级 === 5).length,\n    );\n    if (gachaFiveStarCountArr.length === 0) return;\n    gachaFiveStarCountArr.sort((a, b) => b - a);\n    const fiveStarCount = gachaFiveStarCountArr[0];\n    if (fiveStarCount <= 1) return;\n    const count = gachaFiveStarCountArr.lastIndexOf(fiveStarCount) + 1; // 达成次数\n    const mapping = ['单', '双', '三', '四', '五', '六', '七', '八', '九', '十'];\n    let extraInfo = '';\n    if (fiveStarCount >= 3) extraInfo = '，你就是极致的欧皇!';\n    return {\n      title: `「${mapping[fiveStarCount - 1]}黄蛋!」`,\n      info: `在一次十连中，你抽取到了 ${fiveStarCount} 只五星${extraInfo}`,\n      value: count,\n      achievedTime: '达成次数',\n    };\n  },\n  function gacha10getMoreThanFive({ gacha }) {\n    // github issue #5  @zhsitao (https://github.com/zhsitao)\n    if (gacha[10].length === 0) return;\n    const isFit = (item: DataItem) => item.星级 >= 4;\n    function getFourFiveStarCount(data: DataItem[]) {\n      let count = 0;\n      for (let i = 0; i < data.length; i++) {\n        const item = data[i];\n        if (isFit(item)) count++;\n      }\n      return count;\n    }\n    const list = gacha[10].filter(({ data }) => {\n      return getFourFiveStarCount(data) >= 5;\n    });\n    if (list.length === 0) {\n      const countMoreThanFourList = gacha[10].filter(({ data }) => {\n        return getFourFiveStarCount(data) >= 4;\n      });\n      if (countMoreThanFourList.length === 0) return;\n      return {\n        title: '「四叶草」',\n        info: `在一次十连中，抽取到 4 个或以上的 4 星或 5 星`,\n        value: `${countMoreThanFourList.length}`,\n        achievedTime: `达成次数`,\n      };\n    }\n    return {\n      title: '「福至五彩」',\n      info: `在一次十连中，抽取到 5 个或以上的 4 星或 5 星`,\n      value: `${list.length}`,\n      achievedTime: `达成次数`,\n    };\n  },\n  function characterMoreThanWeapon({ gacha }) {\n    // github issue #5  @zhsitao (https://github.com/zhsitao)\n    if (gacha[10].length === 0) return;\n    function getWeaponCount(data: DataItem[]) {\n      let count = 0;\n      for (let i = 0; i < data.length; i++) {\n        const item = data[i];\n        if (isWeapon(item)) count++;\n      }\n      return count;\n    }\n    const list = gacha[10].filter(({ data }) => {\n      return getWeaponCount(data) <= 5;\n    });\n    if (list.length === 0) return;\n    const maxData = minBy(list, ({ data }) => getWeaponCount(data))!;\n    const maxCount = 10 - getWeaponCount(maxData.data);\n    return {\n      title: '「这才是角色池！」',\n      info: `在一次十连中，抽出的角色不少于武器`,\n      value: `角色：${maxCount}`,\n      achievedTime: `${maxData.data[0].时间}`,\n    };\n  },\n  function maxFiveStarCharacter({ character }) {\n    const sortedData = Object.values(character[5]).sort((b, a) => a.data.length - b.data.length);\n    if (sortedData.length === 0) return;\n    const maxNum = sortedData[0].data.length;\n    if (maxNum === 1) return;\n    const endIndex = sortedData.findIndex((v) => v.data.length !== maxNum);\n    const names = sortedData\n      .slice(0, endIndex)\n      .map((item) => defaultFormatter(item.data[0].名称, item.data.length));\n    return {\n      title: '「情有独钟(五星角色)」',\n      info: `你共抽取了 ${names.join('、')}，这是上天对你的眷顾还是你对${\n        names.length === 1 ? ' ta ' : '他们'\n      }的情有独钟呢？`,\n    };\n  },\n  function maxFourStarCharacter({ character }) {\n    const sortedData = Object.values(character[4]).sort((b, a) => a.data.length - b.data.length);\n    if (sortedData.length === 0) return;\n    const maxNum = sortedData[0].data.length;\n    if (maxNum === 1) return;\n    const endIndex = sortedData.findIndex((v) => v.data.length !== maxNum);\n    const names = sortedData\n      .slice(0, endIndex)\n      .map((item) => defaultFormatter(item.data[0].名称, item.data.length));\n    return {\n      title: '「情有独钟(四星角色)」',\n      info: `你共抽取了 ${names.join('、')}，这是上天对你的眷顾还是你对${\n        names.length === 1 ? ' ta ' : '他们'\n      }的情有独钟呢？`,\n    };\n  },\n];\n","/**\n * render achievements to canvas\n * 先定位再绘制，因此很多都返回{width:xxx, draw} 格式，调用draw时才绘制\n */\n/** @jsxImportSource @emotion/react */\nimport { AchievementCardProps } from 'components/AchievementCard';\nimport { FONT_FAMILY, FONT_FAMILY_BOLD } from 'const';\nimport AchievedPng from 'resource/achievement_achieved.png';\nimport ShowPng from 'resource/achievement_show.png';\n// @ts-ignore\n\nconst WIDTH = 750;\n\nfunction getFont(size: number) {\n  return `${size}px ${FONT_FAMILY_BOLD},${FONT_FAMILY}`;\n}\n// draw text auto change line\nfunction drawText(\n  ctx: CanvasRenderingContext2D,\n  {\n    text,\n    width,\n    letterSpace = 0,\n    lineHeight,\n    ...props\n  }: {\n    text: string;\n    width?: number;\n    letterSpace?: number;\n    lineHeight?: number;\n    font: CanvasRenderingContext2D['font'];\n    fillStyle: CanvasRenderingContext2D['fillStyle'];\n    textBaseline?: CanvasRenderingContext2D['textBaseline'];\n    textAlign?: CanvasRenderingContext2D['textAlign'];\n  },\n) {\n  const loc = {\n    x: 0,\n    y: 0,\n  };\n  const chars = text.split('');\n  if (lineHeight === undefined) {\n    const match = props.font.match(/\\d\\dpx/);\n    if (match === null) throw new Error('match error');\n    else lineHeight = parseFloat(match[0]) * 1.3;\n  }\n  const data: Array<{\n    char: string;\n    x: number;\n    y: number;\n  }> = [];\n  const save: Array<{\n    key: string;\n    v: string;\n  }> = [];\n  function restore() {\n    save.forEach(({ key, v }) => {\n      (ctx as any)[key] = v;\n    });\n  }\n  Object.keys(props).forEach((key) => {\n    const v = (ctx as any)[key];\n    if (v !== (props as any)[key]) {\n      save.push({\n        key,\n        v,\n      });\n      (ctx as any)[key] = (props as any)[key];\n    }\n  });\n  if (width === undefined) {\n    for (let i = 0; i < chars.length; i++) {\n      const char = chars[i];\n      const { width: charWidth } = ctx.measureText(char);\n      data.push({\n        char,\n        x: loc.x,\n        y: loc.y,\n      });\n      loc.x += charWidth + letterSpace;\n    }\n  } else {\n    for (let i = 0; i < chars.length; i++) {\n      const char = chars[i];\n      const { width: charWidth } = ctx.measureText(char);\n      if (loc.x + charWidth + letterSpace > width) {\n        loc.y += lineHeight;\n        loc.x = 0;\n        i--;\n      } else {\n        data.push({\n          char,\n          x: loc.x,\n          y: loc.y,\n        });\n        loc.x += charWidth + letterSpace;\n      }\n    }\n  }\n  restore();\n  return {\n    draw(x: number, y: number) {\n      Object.keys(props).forEach((key) => {\n        (ctx as any)[key] = (props as any)[key];\n      });\n      data.forEach(({ char, x: sx, y: sy }) => {\n        ctx.fillText(char, x + sx, y + sy);\n      });\n      restore();\n    },\n    width: width === undefined ? loc.x - letterSpace : width,\n    height: loc.y + lineHeight,\n  };\n}\n// loadImage to avoid async\nconst loadImage = (function () {\n  const cache: {\n    [key: string]: HTMLImageElement;\n  } = Object.create(null);\n  const loading: {\n    [key: string]: Array<(image: HTMLImageElement) => void>;\n  } = Object.create(null);\n  function loadImage(src: string, cb: (image: HTMLImageElement) => void): void;\n  function loadImage(src: string[], cb: (image: HTMLImageElement[]) => void): void;\n  function loadImage(src: any, cb: any) {\n    if (Array.isArray(src)) {\n      let i = 0;\n      const data: HTMLImageElement[] = [];\n      src.forEach((str) => {\n        loadImage(str, (image) => {\n          data[i] = image;\n          i++;\n          if (i === src.length) cb(data);\n        });\n      });\n      return;\n    }\n    if (src in cache) {\n      cb(cache[src]);\n    } else {\n      if (src in loading) loading[src].push(cb);\n      else {\n        loading[src] = [cb];\n        const image = new Image();\n        image.src = src;\n        image.onload = function (e) {\n          const data = loading[src];\n          delete loading[src];\n          cache[src] = image;\n          data.forEach((f) => f(image));\n        };\n        image.onerror = function (e) {\n          delete loading[src];\n        };\n      }\n    }\n  }\n  return loadImage;\n})();\nfunction drawImage(\n  ctx: CanvasRenderingContext2D,\n  src: string,\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n  callback?: () => void,\n) {\n  const cb = function (image: HTMLImageElement) {\n    ctx.drawImage(image, x, y, width, height);\n    callback && callback();\n  };\n  loadImage(src, cb);\n}\n\nfunction drawOneAchievement(ctx: CanvasRenderingContext2D, achievement: AchievementCardProps) {\n  const HEIGHT = 108;\n  const BORDER_WIDTH = 2;\n  const MARGIN_H = 4;\n  const MARGIN_W = 8;\n  const BORDER_MARGIN_W = BORDER_WIDTH + MARGIN_W;\n  const BORDER_MARGIN_H = BORDER_WIDTH + MARGIN_H;\n  const { width: LEFT_ZONE_WIDTH, draw: drawLeft } = drawLeftZone(ctx);\n  const { width: RIGHT_ZONE_WIDTH, draw: drawRight } = drawRightZone(ctx, {\n    value: achievement.value,\n    achievedTime: achievement.achievedTime,\n  });\n  const contentWidth = WIDTH - 2 * BORDER_MARGIN_W - LEFT_ZONE_WIDTH - RIGHT_ZONE_WIDTH;\n  const { height: fontHeight, draw: drawContent } = drawContentZone(ctx, {\n    width: contentWidth,\n    info: achievement.info,\n    title: achievement.title,\n  });\n  const contentHeight = Math.max(fontHeight, HEIGHT - 2 * BORDER_WIDTH - 2 * MARGIN_H);\n  return {\n    height: contentHeight + 2 * BORDER_WIDTH + 2 * MARGIN_H,\n    draw(x: number, y: number) {\n      ctx.textBaseline = 'top';\n      ctx.fillStyle = '#ebe2d8';\n      ctx.fillRect(\n        x + BORDER_MARGIN_W,\n        y + BORDER_MARGIN_H,\n        WIDTH - 2 * BORDER_MARGIN_W,\n        contentHeight,\n      );\n      ctx.strokeStyle = '#e0d6cb';\n      ctx.lineWidth = BORDER_WIDTH;\n      ctx.lineJoin = 'round';\n      const tmp_w = MARGIN_W + BORDER_WIDTH / 2;\n      const tmp_h = MARGIN_H + BORDER_WIDTH / 2;\n      ctx.strokeRect(x + tmp_w, y + tmp_h, WIDTH - 2 * tmp_w, contentHeight + BORDER_WIDTH);\n      drawLeft(x + BORDER_MARGIN_W, y + BORDER_MARGIN_H, contentHeight);\n      drawContent(x + BORDER_MARGIN_W + LEFT_ZONE_WIDTH, y + BORDER_MARGIN_H, contentHeight);\n      drawRight(x + WIDTH - BORDER_MARGIN_W, y + BORDER_MARGIN_H, contentHeight);\n    },\n  };\n}\n// draw left logo\nfunction drawLeftZone(ctx: CanvasRenderingContext2D) {\n  const IMAGE_WIDTH = 104;\n  const IMAGE_HEIGHT = 104;\n  const SIZE = 80;\n  const WIDTH = SIZE;\n  const HEIGHT = SIZE;\n  const LEFT_PADDING = 16;\n  const RIGHT_PADDING = 16;\n  return {\n    width: LEFT_PADDING + WIDTH + RIGHT_PADDING,\n    draw(left: number, top: number, contentHeight: number) {\n      drawImage(\n        ctx,\n        AchievedPng,\n        left + LEFT_PADDING,\n        top + contentHeight / 2 - HEIGHT / 2,\n        WIDTH,\n        HEIGHT,\n      );\n    },\n  };\n}\n// draw text\nfunction drawContentZone(\n  ctx: CanvasRenderingContext2D,\n  {\n    width,\n    title,\n    info,\n  }: {\n    width: number;\n    title: string;\n    info: string;\n  },\n) {\n  const PADDING_TOP = 12;\n  const PADDING_BOTTOM = 12;\n  const SPACE = 8;\n  const { height: titleHeight, draw: drawTitle } = drawText(ctx, {\n    text: title,\n    width,\n    fillStyle: '#585757',\n    font: getFont(20),\n  });\n  const { height: infoHeight, draw: drawInfo } = drawText(ctx, {\n    text: info,\n    width,\n    fillStyle: '#988b81',\n    font: getFont(16),\n  });\n  const height = titleHeight + SPACE + infoHeight;\n  return {\n    height: PADDING_TOP + height + PADDING_BOTTOM,\n    draw(left: number, top: number, contentHeight: number) {\n      let x = left,\n        y = top + contentHeight / 2 - height / 2;\n      drawTitle(x, y);\n      y += titleHeight + SPACE;\n      drawInfo(x, y);\n    },\n  };\n}\n// draw right zone\nfunction drawRightZone(\n  ctx: CanvasRenderingContext2D,\n  {\n    achievedTime,\n    value,\n  }: {\n    value?: string | number;\n    achievedTime?: string;\n  },\n) {\n  const IMAGE_WIDTH = 147;\n  const IMAGE_HEIGHT = 115;\n  const HEIGHT = 96;\n  const WIDTH = 140;\n  const realImageWidth = (HEIGHT / IMAGE_HEIGHT) * IMAGE_WIDTH;\n  return {\n    width: WIDTH,\n    draw(right: number, top: number, contentHeight: number) {\n      function drawValue() {\n        if (value !== undefined) {\n          const { width, draw } = drawText(ctx, {\n            text: value.toString(),\n            font: getFont(20),\n            fillStyle: '#988b81',\n            textBaseline: 'middle',\n          });\n          draw(right - realImageWidth / 2 - width / 2, top + contentHeight / 2);\n        }\n      }\n      if (achievedTime) {\n        drawImage(\n          ctx,\n          ShowPng,\n          right - realImageWidth,\n          top + contentHeight / 2 - HEIGHT / 2,\n          realImageWidth,\n          HEIGHT,\n          () => {\n            drawValue();\n            const { width, draw } = drawText(ctx, {\n              text: achievedTime,\n              font: getFont(15),\n              fillStyle: '#988b81',\n              textBaseline: 'middle',\n            });\n            draw(right - realImageWidth / 2 - width / 2, top + contentHeight / 2 + 34);\n          },\n        );\n      } else drawValue();\n    },\n  };\n}\n\nfunction drawEndLine(ctx: CanvasRenderingContext2D) {\n  const LINE_PADDING = 20;\n  const {\n    width: fontWidth,\n    height,\n    draw,\n  } = drawText(ctx, {\n    text: 'https://genshin.voderl.cn/',\n    font: `13px ${FONT_FAMILY}`,\n    fillStyle: '#988b81',\n    letterSpace: 1,\n    textBaseline: 'middle',\n  });\n  const HEIGHT = 20;\n  return {\n    height: HEIGHT,\n    draw(top: number) {\n      ctx.fillStyle = '#585757';\n      ctx.lineCap = 'round';\n      ctx.lineWidth = 2;\n      const centerY = top + HEIGHT / 2;\n      ctx.beginPath();\n      ctx.moveTo(LINE_PADDING, centerY);\n      ctx.lineTo(WIDTH / 2 - fontWidth / 2 - LINE_PADDING, centerY);\n      ctx.closePath();\n      ctx.stroke();\n      ctx.beginPath();\n      ctx.moveTo(WIDTH / 2 + fontWidth / 2 + LINE_PADDING, centerY);\n      ctx.lineTo(WIDTH - LINE_PADDING, centerY);\n      ctx.closePath();\n      ctx.stroke();\n      draw(WIDTH / 2 - fontWidth / 2, centerY);\n    },\n  };\n}\nexport function renderToCanvas(\n  achievements: AchievementCardProps[],\n  cb: (canvas: HTMLCanvasElement, ctx: CanvasRenderingContext2D) => void,\n) {\n  const canvas = document.createElement('canvas');\n  const ctx: CanvasRenderingContext2D = canvas.getContext('2d', {\n    alpha: false,\n  }) as any;\n  loadImage([AchievedPng, ShowPng], (data) => {\n    const TOP_BOTTOM_PADDING = 2;\n    let x = 0,\n      y = TOP_BOTTOM_PADDING;\n    const draws = []; // store draw method\n    for (let i = 0; i < achievements.length; i++) {\n      const item = achievements[i];\n      const { height, draw } = drawOneAchievement(ctx, item);\n      draws.push(\n        (function (sx, sy) {\n          return () => void draw(sx, sy);\n        })(x, y),\n      );\n      y += height;\n    }\n    const { height: endLineHeight, draw: drawEnd } = drawEndLine(ctx);\n    canvas.width = WIDTH;\n    canvas.height = y + TOP_BOTTOM_PADDING + endLineHeight;\n    ctx.fillStyle = '#f0eae2';\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    draws.forEach((f) => f());\n    drawEnd(y);\n    cb(canvas, ctx);\n  });\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { Button, Divider, message } from 'antd';\nimport { AchievementCard, AchievementCardProps } from 'components/AchievementCard';\nimport { IconButton } from 'components/IconButton';\nimport ShareAltOutlined from '@ant-design/icons/ShareAltOutlined';\nimport FormOutlined from '@ant-design/icons/FormOutlined';\nimport MinusCircleTwoTone from '@ant-design/icons/MinusCircleTwoTone';\nimport PlusCircleTwoTone from '@ant-design/icons/PlusCircleTwoTone';\nimport CloseOutlined from '@ant-design/icons/CloseOutlined';\nimport { FONT_FAMILY_BOLD, FONT_FAMILY, SHOW_DATA_ALL_KEY, ISMOBILE } from 'const';\nimport React, { FC, useCallback, useMemo, useState } from 'react';\nimport { Data, DataItem, StarCacheType, GachaCacheType, DayCacheType } from 'types';\nimport { achievements as achievementsFunc } from './achievements';\nimport { renderToCanvas } from './renderToCanvas';\nimport { useCacheMemo } from 'context/CacheContext';\nimport { FriendLinks } from 'components/FriendLinks';\nimport renderPngTip from 'utils/renderPngTip';\nimport downloadCanvas from 'utils/downloadCanvas';\nimport parseToDate from 'utils/parseToDate';\n\ntype AchievementsProps = {\n  onGetData: (key: string) => Data;\n  sheetNames: string[];\n};\n\nexport const POOLS = {\n  CHARACTER: 0,\n  WEAPON: 1,\n  PERMANENT: 2,\n  NOVICE: 3,\n};\nexport const EN_SHEETS = [\n  'Character Event Wish',\n  'Weapon Event Wish',\n  'Permanent Wish',\n  'Novice Wish',\n];\nexport const CN_SHEETS = ['角色活动祈愿', '武器活动祈愿', '常驻祈愿', '新手祈愿'];\nfunction getSheetKey(key: any, sheetNames: string[]) {\n  const isChinese = CN_SHEETS.indexOf(sheetNames[0]) !== -1;\n  return isChinese ? CN_SHEETS[key] : sheetNames[key];\n}\nconst iconCss = css`\n  position: absolute;\n  left: 0;\n  top: 50%;\n  transform: translate(-50%, -50%);\n  font-size: 24px;\n  padding: 10px;\n`;\nconst WrappedAchievementCard: FC<{\n  isEditMode: boolean;\n  visible: boolean;\n  item: AchievementCardProps & {\n    visible: boolean;\n  };\n}> = function ({ isEditMode, item, visible }) {\n  const [isVisible, setVisible] = useState(visible);\n  const handleHide = useCallback(() => {\n    setVisible(!isVisible);\n    item.visible = !isVisible;\n  }, [isVisible]);\n  return (\n    <div style={{ opacity: isVisible ? 1 : 0.5, position: 'relative' }}>\n      <AchievementCard {...item}>\n        {isEditMode &&\n          (isVisible ? (\n            <MinusCircleTwoTone twoToneColor='#ee675c' css={iconCss} onClick={handleHide} />\n          ) : (\n            <PlusCircleTwoTone twoToneColor='#5bb974' css={iconCss} onClick={handleHide} />\n          ))}\n      </AchievementCard>\n    </div>\n  );\n};\nexport const Achievements: FC<AchievementsProps> = function ({ onGetData, sheetNames }) {\n  const allAchievements = useCacheMemo(\n    () => {\n      const allData = onGetData(SHOW_DATA_ALL_KEY);\n      // 将数据分散到表里面，做一个缓存处理，方便对数据进行筛选\n      const character: StarCacheType = {\n        '5': {},\n        '4': {},\n      };\n      const all: StarCacheType = {\n        '5': {},\n        '4': {},\n        '3': {},\n      };\n      const weapon: StarCacheType = {\n        '5': {},\n        '4': {},\n        '3': {},\n      };\n      const day: DayCacheType = {};\n      const gacha: GachaCacheType = {\n        10: [],\n        1: [],\n      };\n      const pools = {\n        character: onGetData(getSheetKey(POOLS.CHARACTER, sheetNames)),\n        weapon: onGetData(getSheetKey(POOLS.WEAPON, sheetNames)),\n        novice: onGetData(getSheetKey(POOLS.NOVICE, sheetNames)),\n        permanent: onGetData(getSheetKey(POOLS.PERMANENT, sheetNames)),\n      };\n      const walk = (item: DataItem) => {\n        let cache = item.类别 === '角色' ? character : weapon;\n        if (item.名称 in all[item.星级]) all[item.星级][item.名称].data.push(item);\n        else {\n          all[item.星级][item.名称] = {\n            data: [item],\n          };\n        }\n        const currentDay = item.时间.slice(0, 10);\n        if (currentDay in day) {\n          day[currentDay].data.push(item);\n        } else {\n          day[currentDay] = { data: [item] };\n        }\n        if (!(item.名称 in cache[item.星级])) {\n          cache[item.星级][item.名称] = {\n            data: [item],\n          };\n        } else cache[item.星级][item.名称].data.push(item);\n      };\n      for (let i = 0, len = allData.length; i < len; ) {\n        const current = allData[i];\n        if (i < len - 1 && allData[i + 1].date === current.date) {\n          const temp = allData.slice(i, i + 10);\n          temp.forEach(walk);\n          gacha[10].push({\n            data: temp,\n          });\n          i = i + 10;\n        } else {\n          walk(current);\n          gacha[1].push(current);\n          i++;\n        }\n      }\n      const info = {\n        all,\n        character,\n        weapon,\n        data: allData,\n        gacha,\n        day,\n        pools,\n      };\n      if (process.env.NODE_ENV === 'development') console.log(info);\n      const isDate = (str: string) => parseToDate(str).toString() !== 'Invalid Date';\n      const result = achievementsFunc\n        .map((func) => func(info))\n        .reduce((acc: Array<any>, cur: any) => {\n          if (Array.isArray(cur)) return acc.concat(cur);\n          if (typeof cur === 'object') acc.push(cur);\n          return acc;\n        }, []);\n      result.forEach((data) => {\n        const achievedTime = data.achievedTime;\n        if (achievedTime && isDate(achievedTime)) {\n          data.achievedTime = achievedTime.slice(0, 10).replace(/-/g, '/');\n        }\n        data.visible = true;\n      });\n      return result;\n    },\n    [],\n    'achievements',\n  );\n  const [achievements, setAchievements] = useState(allAchievements);\n  const [isEditMode, setEditMode] = useState(false);\n  const handleRenderPng = useCallback(() => {\n    const data = achievements.filter((item) => item.visible !== false);\n    renderPngTip((resolve, reject) => {\n      renderToCanvas(data, (canvas, ctx) => {\n        downloadCanvas(canvas, 'achievements.png', resolve);\n      });\n    });\n  }, [achievements]);\n  const handleEdit = useCallback(() => {\n    setEditMode(!isEditMode);\n    if (!isEditMode) {\n      message.info('进入编辑模式，可以设置单个成就是否展示');\n      setAchievements(allAchievements);\n    } else setAchievements(allAchievements.filter((item) => item.visible));\n  }, [isEditMode]);\n  return (\n    <div\n      css={css`\n        overflow: auto;\n        background: #f0eae2;\n        font-family: ${FONT_FAMILY_BOLD}, ${FONT_FAMILY};\n      `}\n    >\n      {!ISMOBILE && (\n        <div\n          css={css`\n            position: fixed;\n            right: 8%;\n            z-index: 999;\n            top: 64px;\n          `}\n        >\n          <IconButton\n            placement='right'\n            tip='生成图片'\n            icon={<ShareAltOutlined />}\n            onClick={handleRenderPng}\n          />\n          <br />\n          <IconButton\n            placement='right'\n            tip={isEditMode ? '退出编辑' : '编辑成就'}\n            icon={isEditMode ? <CloseOutlined /> : <FormOutlined />}\n            onClick={handleEdit}\n          />\n        </div>\n      )}\n      {achievements.map((props) => (\n        <WrappedAchievementCard\n          key={props.title}\n          item={props}\n          visible={props.visible}\n          isEditMode={isEditMode}\n        />\n      ))}\n      <Button\n        type='primary'\n        css={css`\n          display: block;\n          margin: 10px auto;\n        `}\n        onClick={handleRenderPng}\n      >\n        生成图片\n      </Button>\n      <Divider>\n        <a href='https://github.com/voderl/genshin-gacha-analyzer/issues' target='_blank'>\n          更多成就开发中，欢迎前往issue提出你的建议...\n        </a>\n      </Divider>\n      <FriendLinks mode='bottom' />\n    </div>\n  );\n};\n","/** Sider 电脑端手机端对应不同的侧边栏 */\n/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { FC, memo } from 'react';\nimport { Layout, Menu } from 'antd';\nimport RawGithubCorner from 'react-github-corner';\nimport BarChartOutlined from '@ant-design/icons/BarChartOutlined';\nimport UnorderedListOutlined from '@ant-design/icons/UnorderedListOutlined';\nimport StarOutlined from '@ant-design/icons/StarOutlined';\nimport PieChartOutlined from '@ant-design/icons/PieChartOutlined';\nimport { FriendLinks } from 'components/FriendLinks';\n\nconst { Sider, Header } = Layout;\n\ninterface CustomSiderProps {\n  isVertical: boolean;\n  activeMenu: string;\n  onMenuChange: ({ key }: any) => any;\n}\n\nconst GithubCorner = memo(\n  ({ size }: { size: number }) => (\n    <RawGithubCorner\n      href='https://github.com/voderl/genshin-gacha-analyzer'\n      target='_blank'\n      direction='left'\n      bannerColor='#70B7FD'\n      octoColor='#fff'\n      size={size}\n    />\n  ),\n  (_, props) => _.size === props.size,\n);\n\nconst isVerticalMenuStyle = css`\n  .ant-menu-item {\n    margin: 0 10px !important;\n    height: 48px;\n    line-height: 48px;\n  }\n`;\nconst notIsVerticalMenuStyle = css`\n  margin-top: 80px;\n  .ant-menu-item {\n    height: 60px;\n    line-height: 60px;\n  }\n`;\nconst CustomSider: FC<CustomSiderProps> = ({ isVertical, onMenuChange, activeMenu }) => {\n  const children = [\n    <GithubCorner size={isVertical ? 30 : 60} />,\n    <Menu\n      mode={isVertical ? 'horizontal' : 'inline'}\n      defaultSelectedKeys={[activeMenu]}\n      onSelect={onMenuChange}\n      css={isVertical ? isVerticalMenuStyle : notIsVerticalMenuStyle}\n    >\n      <Menu.Item key='timeline' icon={<BarChartOutlined />}>\n        时间轴\n      </Menu.Item>\n      <Menu.Item key='analysisChart' icon={<PieChartOutlined />}>\n        分析图\n      </Menu.Item>\n      <Menu.Item key='achievements' icon={<StarOutlined />}>\n        成就表\n      </Menu.Item>\n      <Menu.Item key='rawData' icon={<UnorderedListOutlined />}>\n        原数据\n      </Menu.Item>\n    </Menu>,\n  ];\n  if (isVertical)\n    return (\n      <Header\n        css={css`\n          padding-left: 20px;\n          padding-right: 0px;\n          background: #fff;\n          line-height: 56px;\n        `}\n      >\n        {children}\n      </Header>\n    );\n  return (\n    <Sider\n      breakpoint='lg'\n      theme='light'\n      width='15%'\n      style={{\n        height: '100vh',\n      }}\n    >\n      {children}\n      <FriendLinks mode='left' />\n    </Sider>\n  );\n};\n\nexport default CustomSider;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { FC, useCallback, useMemo, useState, Suspense, lazy, memo } from 'react';\nimport { Layout, Spin } from 'antd';\nimport { useGlobalContext } from 'context/GlobalContext';\nimport { POOL_NAME_TO_TYPE, POOL_TYPE_TO_NAME, SHOW_DATA_ALL_KEY } from 'const';\nimport { Data, DataItem } from 'types';\nimport { Achievements } from './Achievements';\nimport CustomSider from './CustomSider';\nimport { CacheContextProvider, clearGlobalCache } from 'context/CacheContext';\n\nconst ShowData = lazy(() =>\n  import(/* webpackPrefetch: true */ './ShowData').then((module) => ({\n    default: module.ShowData,\n  })),\n);\nconst Timeline = lazy(() =>\n  import(/* webpackPrefetch: true */ './Timeline').then((module) => ({\n    default: module.Timeline,\n  })),\n);\nconst AnalysisChart = lazy(() =>\n  import(/* webpackPrefetch: true */ './AnalysisChart').then((module) => ({\n    default: module.AnalysisChart,\n  })),\n);\n\ntype ShowPageProps = {};\nconst { Content } = Layout;\n\nexport const ShowPage: FC<ShowPageProps> = function () {\n  const { parsedData, isVertical } = useGlobalContext();\n  const sheetNames = Object.values(POOL_TYPE_TO_NAME);\n  const getJson = useMemo(() => {\n    clearGlobalCache();\n    const cache = Object.create(null);\n    function getJson(key: string) {\n      if (key in cache) return cache[key];\n      let data: Data;\n      if (key === SHOW_DATA_ALL_KEY) {\n        data = sheetNames.reduce((acc: Array<any>, cur: string) => acc.concat(getJson(cur)), []);\n        data.sort((a, b) => (a.date === b.date ? a.总次数 - b.总次数 : a.date - b.date));\n      } else {\n        const type = (POOL_NAME_TO_TYPE as any)[key];\n        data = (parsedData as any)[type];\n      }\n      return (cache.key = data);\n    }\n    return getJson;\n  }, [parsedData]);\n  const [activeMenu, setActiveMenu] = useState('analysisChart');\n  const handleMenuChange = useCallback(({ key }: any) => {\n    setActiveMenu(key);\n  }, []);\n  const renderContent = useCallback((key) => {\n    if (key === 'rawData') return <ShowData onGetData={getJson} tabs={sheetNames} />;\n    else if (key === 'analysisChart')\n      return <AnalysisChart sheetNames={sheetNames} onGetData={getJson} />;\n    else if (key === 'timeline') return <Timeline onGetData={getJson} />;\n    else if (key === 'achievements')\n      return <Achievements onGetData={getJson} sheetNames={sheetNames} />;\n    else return <div>暂无</div>;\n  }, []);\n  return (\n    <Layout\n      css={css`\n        width: 100%;\n        height: 100%;\n        position: absolute;\n        display: flex;\n      `}\n      style={{\n        flexDirection: isVertical ? 'column' : 'row',\n      }}\n    >\n      <CustomSider\n        isVertical={isVertical}\n        onMenuChange={handleMenuChange}\n        activeMenu={activeMenu}\n      />\n      <Content\n        css={css`\n          margin: 0;\n          position: relative;\n          width: 100%;\n          height: 100%;\n          overflow-x: hidden;\n          overflow-y: auto;\n        `}\n      >\n        <CacheContextProvider path={activeMenu}>\n          <Suspense\n            fallback={\n              <Spin\n                size='large'\n                tip='加载中...'\n                css={css`\n                  display: block;\n                  margin: 150px auto;\n                `}\n              />\n            }\n          >\n            {renderContent(activeMenu)}\n          </Suspense>\n        </CacheContextProvider>\n      </Content>\n    </Layout>\n  );\n};\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { lazy, Suspense, useEffect, useState } from 'react';\nimport { message, Spin, Alert } from 'antd';\nimport { GlobalContextProvider, useGlobalContext } from './context/GlobalContext';\nimport { LoadPage } from './pages/LoadPage';\nimport { ShowPage } from './pages/ShowPage';\n\nimport './App.css';\nimport { decompressFromHash } from 'utils/compress';\n\nconst MergePage = lazy(() =>\n  import('./pages/MergePage').then((module) => ({\n    default: module.MergePage,\n  })),\n);\n\nfunction App() {\n  const { parsedData, page, updateParsedData } = useGlobalContext();\n  const [error, setError] = useState('');\n\n  useEffect(() => {\n    if (!parsedData) {\n      try {\n        let data = decompressFromHash();\n        if (data) {\n          updateParsedData(data);\n          setError('');\n        }\n      } catch (error) {\n        const info = '解析过程中出现错误，请检查链接是否完全复制，如需反馈请加群 853150041 ';\n        setError(info);\n        message.error(info);\n      }\n    }\n  }, [window.location.hash]);\n\n  if (page === 'merge')\n    return (\n      <Suspense\n        fallback={\n          <Spin\n            size='large'\n            tip='加载中...'\n            css={css`\n              display: block;\n              margin: 150px auto;\n            `}\n          />\n        }\n      >\n        <MergePage />\n      </Suspense>\n    );\n  return parsedData === null ? (\n    <>\n      {error && <Alert type='error' message={error} banner />}\n      <LoadPage />\n    </>\n  ) : (\n    <ShowPage />\n  );\n}\nfunction WrappedApp() {\n  return (\n    <GlobalContextProvider>\n      <App />\n    </GlobalContextProvider>\n  );\n}\nexport default WrappedApp;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import './polyfills';\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root'),\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","/**\n * webkit browser like safari don't support time format \"2020-09-28 10:25:28\"\n */\nconst matchNumber = /\\d+/g;\nconst InvalidDate = new Date('');\nexport default function parseToDate(date: any) {\n  if (typeof date !== 'string') return new Date(date);\n  const parts = date.match(matchNumber);\n  if (parts === null) return InvalidDate;\n  // @ts-ignore\n  return new Date(parts[0], parts[1] && parseInt(parts[1]) - 1, ...parts.slice(2));\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { Tooltip, TooltipProps } from 'antd';\nimport { FONT_FAMILY } from 'const';\nimport { useGlobalContext } from 'context/GlobalContext';\nimport { FC } from 'react';\n\ninterface FriendLinksProps {\n  mode: 'left' | 'bottom';\n  visible?: boolean;\n}\n\ntype LinkType = {\n  title: string;\n  link: string;\n  tip: string;\n};\n\nconst Links: LinkType[] = [\n  {\n    title: '可莉特调',\n    link: 'https://genshin.pub/',\n    tip: '一些很好用的原神工具~',\n  },\n];\nconst EllipsisStyle = css`\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n`;\nconst Separator = () => <>/</>;\nexport const FriendLinks: FC<FriendLinksProps> = ({ mode, visible }) => {\n  const { isVertical } = useGlobalContext();\n  if (visible === false) return <></>;\n  if (mode === 'bottom') {\n    if (!isVertical && visible !== true) return <></>;\n    return (\n      <div\n        css={css`\n          text-align: center;\n          font-size: 14px;\n          padding-bottom: 12px;\n          font-family: ${FONT_FAMILY};\n        `}\n      >\n        <span>友情链接：</span>\n        {Links.reduce((acc, { title, link, tip }, index) => {\n          if (index === 0) acc.push(<Separator />);\n          acc.push(\n            <span\n              key={title}\n              css={css`\n                padding: 8px 12px;\n              `}\n            >\n              <Tooltip title={tip} placement='top'>\n                <a target='_blank' href={link}>\n                  {title}\n                </a>\n              </Tooltip>\n            </span>,\n          );\n          acc.push(<Separator />);\n          return acc;\n        }, [] as any[])}\n      </div>\n    );\n  }\n  return (\n    <div\n      css={css`\n        position: absolute;\n        width: 100%;\n        text-align: center;\n        bottom: 20px;\n        left: 0px;\n        padding: 0;\n        & > ul {\n          padding-left: 0px;\n        }\n      `}\n    >\n      <span css={EllipsisStyle}>友情链接：</span>\n      <ul>\n        {Links.map(({ title, link, tip }) => (\n          <li css={EllipsisStyle}>\n            <Tooltip title={tip} placement='right' key={title}>\n              <a target='_blank' href={link}>\n                {title}\n              </a>\n            </Tooltip>\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n};\n","/**\n * 很多数据都是只计算一次，Menu Tab切换 重复挂载消耗性能， 因此使用全局缓存\n * 可以在开发模式下，控制台输入cache查看当前缓存\n */\nimport React, { useEffect, useMemo, useRef, useState, FC, useContext } from 'react';\n\ntype CacheContextType = {\n  cache: any;\n};\n\nconst createCacheContext = function () {\n  const GlobalCache = Object.create(null);\n  if (process.env.NODE_ENV === 'development') (window as any).cache = GlobalCache;\n  const CacheContext = React.createContext<CacheContextType>({\n    cache: GlobalCache,\n  });\n  const useCacheContext = function (key?: string) {\n    const { cache } = useContext(CacheContext);\n    if (key === undefined) return cache;\n    if (key in cache) return cache[key];\n    return (cache[key] = Object.create(null));\n  };\n  const useCacheState = function (state: any, key: string) {\n    const { cache } = useContext(CacheContext);\n    const [value, setValue] = useState(state);\n    if (key in cache)\n      return [\n        cache[key],\n        (v: any) => {\n          cache[key] = v;\n          setValue(v);\n        },\n      ];\n    return [\n      key in cache ? cache[key] : value,\n      (v: any) => {\n        cache[key] = v;\n        setValue(v);\n      },\n    ];\n  };\n  const useCacheMemo = function <T>(func: () => T, deps: any[], key: string): T {\n    const { cache } = useContext(CacheContext);\n    return useMemo(() => {\n      if (key in cache) return cache[key];\n      return (cache[key] = func());\n    }, deps);\n  };\n  const clearGlobalCache = () => {\n    for (let key in GlobalCache) delete GlobalCache[key];\n  };\n  const CacheContextProvider: FC<{\n    path: string;\n    initValue?: any;\n  }> = function ({ path, initValue, children }) {\n    const parentCache = useCacheContext();\n    if (!(path in parentCache)) parentCache[path] = initValue || Object.create(null);\n    const contextValue = useMemo(() => {\n      const cache = parentCache[path];\n      return {\n        cache,\n      };\n    }, [path, parentCache]);\n    return <CacheContext.Provider value={contextValue}>{children}</CacheContext.Provider>;\n  };\n  return {\n    CacheContextProvider,\n    useCacheContext,\n    useCacheMemo,\n    useCacheState,\n    clearGlobalCache,\n  };\n};\nconst { CacheContextProvider, useCacheContext, useCacheMemo, useCacheState, clearGlobalCache } =\n  createCacheContext();\nexport {\n  CacheContextProvider,\n  useCacheContext,\n  useCacheMemo,\n  createCacheContext,\n  useCacheState,\n  clearGlobalCache,\n};\n","import { IndexRefType } from './types';\n\nconst LEFT_CODE = '0';\nconst RIGTH_CODE = '1';\n\ntype Node =\n  | {\n      val: number;\n      char: string;\n    }\n  | {\n      val: number;\n      left: Node;\n      right: Node;\n    };\n\ntype Tree = {\n  left: Tree | string | null;\n  right: Tree | string | null;\n};\ntype HashType = {\n  [key: string]: number;\n};\ntype MapType = {\n  [key: string]: string;\n};\n\nexport function createHuffmanUtils(hashOrMap: HashType | MapType) {\n  const isHash = typeof Object.values(hashOrMap)[0] === 'number';\n\n  const huffmanTree = isHash\n    ? createHuffmanTreeByHash(hashOrMap as HashType)\n    : createHuffmanTreeByMap(hashOrMap as MapType);\n\n  const map = isHash ? getHuffmanMap(huffmanTree) : hashOrMap;\n\n  return {\n    map,\n    encode(list: string[]) {\n      return encodeByHuffmanTree(map, list);\n    },\n    encodeOnce(str: any) {\n      return encodeOnce(map, str);\n    },\n    decode(str: string) {\n      return decodeByHuffmanTree(huffmanTree, str);\n    },\n    decodeOnce(str: string, indexRef: IndexRefType) {\n      return decodeOnce(huffmanTree, str, indexRef);\n    },\n  };\n}\n\nexport function createHuffmanTreeByHash(hash: HashType): Tree {\n  const nodes: Node[] = Object.keys(hash)\n    .map((key) => ({\n      val: hash[key],\n      char: key,\n    }))\n    .sort((a, b) => a.val - b.val);\n  while (nodes.length > 1) {\n    const [left, right] = nodes.splice(0, 2);\n    const node = {\n      val: left.val + right.val,\n      left,\n      right,\n    };\n    let i = 0;\n    for (; i < nodes.length; i++) {\n      if (nodes[i].val > node.val) break;\n    }\n    nodes.splice(i, 0, node);\n  }\n  const tree = formatNodeToTree(nodes[0]);\n  if (typeof tree === 'string') throw new Error('hash require have more one key');\n  return tree;\n  function formatNodeToTree(node: Node): Tree | string {\n    if ('char' in node) return node.char;\n    return {\n      left: formatNodeToTree(node.left),\n      right: formatNodeToTree(node.right),\n    };\n  }\n}\n\nexport function createHuffmanTreeByMap(map: MapType): Tree {\n  const nodes = Object.keys(map).map((key) => ({\n    char: key,\n    code: map[key],\n  }));\n  const tree = traversal(nodes);\n  if (typeof tree === 'string' || tree === null) throw new Error('map require have more one key');\n  return tree;\n  function traversal(_nodes: typeof nodes, depth = 0): Tree | string | null {\n    if (_nodes.length === 0) return null;\n    if (_nodes.length === 1 && _nodes[0].code.length === depth) return _nodes[0].char;\n    const leftNodes: typeof _nodes = [],\n      rightNodes: typeof _nodes = [];\n    _nodes.forEach((node) => {\n      if (node.code[depth] === LEFT_CODE) leftNodes.push(node);\n      else rightNodes.push(node);\n    });\n    return {\n      left: traversal(leftNodes, depth + 1),\n      right: traversal(rightNodes, depth + 1),\n    };\n  }\n}\n\nexport function getHuffmanMap(tree: Tree) {\n  let hash = Object.create(null);\n  let traversal = (node: Tree | string | null, curPath: string) => {\n    if (node === null) return;\n    if (typeof node === 'string') return void (hash[node] = curPath);\n    traversal(node.left, curPath + LEFT_CODE);\n    traversal(node.right, curPath + RIGTH_CODE);\n  };\n  traversal(tree, '');\n  return hash;\n}\n\nexport function decodeByHuffmanTree(tree: Tree, str: string) {\n  const results: string[] = [];\n  let current = -1;\n  const len = str.length;\n  let traversal = (node: Tree | null) => {\n    if (node === null) throw new Error('unexpected error');\n    if (str.charAt(current) === LEFT_CODE) {\n      if (typeof node.left === 'string') results.push(node.left);\n      else traversal(node.left);\n    } else {\n      if (typeof node.right === 'string') results.push(node.right);\n      else traversal(node.right);\n    }\n  };\n  while (current < len - 1) {\n    traversal(tree);\n  }\n  return results;\n}\n\nexport function decodeOnce(node: Tree | null, str: string, indexRef: IndexRefType): any {\n  if (node === null) throw new Error('unexpected error');\n  if (str.charAt(indexRef.current++) === LEFT_CODE) {\n    if (typeof node.left === 'string') return node.left;\n    return decodeOnce(node.left, str, indexRef);\n  }\n  if (typeof node.right === 'string') return node.right;\n  return decodeOnce(node.right, str, indexRef);\n}\n\nexport function encodeOnce(map: any, str: string) {\n  if (str in map) return map[str];\n  throw new Error(`cannot find key ${str} in map`);\n}\n\nexport function encodeByHuffmanTree(map: any, list: string[]) {\n  return list\n    .map((str) => {\n      if (str in map) return map[str];\n      throw new Error(`cannot find key ${str} in map`);\n    })\n    .join('');\n}\n\n(window as any).createHuffmanTreeByMap = createHuffmanTreeByMap;\n","const keyStrUriSafe = `ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789~=`;\nconst mapping: any = {};\n\nexport const padStart = (s: string, length: number, char = '0') =>\n  char.repeat(length - s.length) + s;\n\nfor (let i = 0; i < keyStrUriSafe.length; i++) {\n  mapping[keyStrUriSafe.charAt(i)] = padStart(i.toString(2), 6, '0');\n}\n\nexport function compressBinaryToEncodedURIComponent(str: string) {\n  const space = (6 - ((str.length + 3) % 6)) % 6;\n  // 转成code，再转成string\n  const results = [];\n  const formattedStr = str + '0'.repeat(space) + padStart(space.toString(2), 3, '0');\n  for (let i = 0, len = formattedStr.length; i < len; ) {\n    results.push(keyStrUriSafe.charAt(parseInt(formattedStr.slice(i, i + 6), 2)));\n    i += 6;\n  }\n  return results.join('');\n}\n\nexport function decompressBinaryFromEncodedURIComponent(str: string) {\n  const chars = [];\n  for (let i = 0, len = str.length; i < len; i++) {\n    chars.push(mapping[str[i]]);\n  }\n  const binaryStrWithSpace = chars.join('');\n  const spaceCount = parseInt(binaryStrWithSpace.slice(-3), 2);\n  return binaryStrWithSpace.slice(0, -3 - spaceCount);\n}\n","/**\n * 每条抽卡数据的 decode 和 encode ，不包括日期\n */\nimport { CHARACTER_POOLS, WEAPON_POOLS } from 'const';\nimport { uniq } from 'lodash';\nimport { DataItem } from 'types';\nimport { createHuffmanUtils } from './huffman';\nimport { IndexRefType } from './types';\nimport { padStart } from './utils';\n\n/**\n * 需保证添加新角色，不更改原有的编码\n */\nfunction buildHuffmanTree(data: string[], bit = 4) {\n  // 同级15个，最后一个向下延伸再15个，一直延伸\n  let prefix = '';\n  const map = {} as any;\n  while (data.length !== 0) {\n    const segs = data.splice(0, Math.pow(2, bit) - 1);\n    segs.forEach((key, index) => (map[key] = prefix + padStart(index.toString(2), bit, '0')));\n    prefix += '1'.repeat(bit);\n  }\n  return createHuffmanUtils(map);\n}\n\nexport const CHARACTER = '角色';\nexport const WEAPON = '武器';\n\nenum ItemType {\n  Weapon3, // 13\n  Weapon4, // 22\n  Weapon5, // 17\n  Character4, // 18\n  Character5, // 14\n}\n\nconst ItemTypeMap = {\n  [ItemType.Weapon3]: '1',\n  [ItemType.Weapon4]: '001',\n  [ItemType.Weapon5]: '0000',\n  [ItemType.Character4]: '01',\n  [ItemType.Character5]: '0001',\n};\n\nconst itemTypeHuffmanUtils = createHuffmanUtils(ItemTypeMap);\n\n// 为不影响之前的编码，只允许后续追加条目\nexport const treeData = {\n  [ItemType.Weapon3]: {\n    extra: {\n      star: 3,\n      type: WEAPON,\n    },\n    tree: buildHuffmanTree([\n      '翡玉法球',\n      '以理服人',\n      '鸦羽弓',\n      '飞天御剑',\n      '沐浴龙血的剑',\n      '黑缨枪',\n      '魔导绪论',\n      '神射手之誓',\n      '弹弓',\n      '铁影阔剑',\n      '黎明神剑',\n      '冷刃',\n      '讨龙英杰谭',\n    ]),\n  },\n  [ItemType.Weapon4]: {\n    extra: {\n      star: 4,\n      type: WEAPON,\n    },\n    tree: buildHuffmanTree(\n      uniq(WEAPON_POOLS.reduce((acc, cur) => acc.push(...cur.four) && acc, [] as any)),\n    ),\n  },\n  [ItemType.Weapon5]: {\n    extra: {\n      type: WEAPON,\n      star: 5,\n    },\n    tree: buildHuffmanTree(\n      uniq(WEAPON_POOLS.reduce((acc, cur) => acc.push(...cur.five) && acc, [] as any)),\n    ),\n  },\n  [ItemType.Character4]: {\n    extra: {\n      type: CHARACTER,\n      star: 4,\n    },\n    tree: buildHuffmanTree(\n      uniq(\n        ['丽莎', '凯亚', '安柏'].concat(\n          CHARACTER_POOLS.reduce((acc, cur) => acc.push(...cur.four) && acc, [] as any),\n        ),\n      ),\n    ),\n  },\n  [ItemType.Character5]: {\n    extra: {\n      type: CHARACTER,\n      star: 5,\n    },\n    tree: buildHuffmanTree(\n      uniq(\n        ['迪卢克', '莫娜', '刻晴', '琴', '七七'].concat(\n          CHARACTER_POOLS.reduce((acc, cur) => acc.push(...cur.five) && acc, [] as any),\n        ),\n      ),\n    ),\n  },\n} as const;\n\nconst mapping = {\n  [CHARACTER]: {\n    4: ItemType.Character4,\n    5: ItemType.Character5,\n  },\n  [WEAPON]: {\n    3: ItemType.Weapon3,\n    4: ItemType.Weapon4,\n    5: ItemType.Weapon5,\n  },\n} as any;\n\nfunction formatToItemType(data: DataItem) {\n  const star = data.星级;\n  const type = data.类别;\n  return mapping[type][star] as ItemType;\n}\nfunction parseFromItemType(itemType: ItemType) {\n  const { star, type } = treeData[itemType].extra;\n  return {\n    星级: star,\n    类别: type,\n  };\n}\nexport function encodeDataItem(data: DataItem) {\n  const itemType = formatToItemType(data);\n  const { encodeOnce } = treeData[itemType].tree;\n  return ItemTypeMap[itemType] + encodeOnce(data.名称);\n}\n\nexport function decodeDataItem(str: string, indexRef: IndexRefType): Partial<DataItem> {\n  const itemType: ItemType = itemTypeHuffmanUtils.decodeOnce(str, indexRef);\n  const name = treeData[itemType].tree.decodeOnce(str, indexRef);\n  return {\n    名称: name,\n    ...parseFromItemType(itemType),\n  };\n}\n","import { createHuffmanUtils } from './huffman';\nimport { padStart } from './utils';\n\n/**\n * 根据抽卡日期数据的特征进行某种压缩\n */\nconst MAX_LENGTH = 32; // 最长数据长度，大概100年\n/**\n * 根据相应算法生成, 没有表明的中间值按照下一个长度处理\n */\nconst LENGTH_TO_HUFFMAN_CODE: any = {\n  '4': '0',\n  '6': '101',\n  '8': '1000',\n  '9': '110001',\n  '13': '1001',\n  '17': '111',\n  '19': '1101',\n  '21': '11001',\n  '22': '1100001',\n  '23': '11000001',\n  '24': '110000001',\n  '25': '1100000001',\n  '32': '1100000000',\n};\n\nconst HUFFMAN_CODE_TO_LENGTH: any = {};\n\nObject.keys(LENGTH_TO_HUFFMAN_CODE).forEach((key) => {\n  HUFFMAN_CODE_TO_LENGTH[LENGTH_TO_HUFFMAN_CODE[key]] = parseInt(key);\n});\n\nconst lengthHuffmanUtils = createHuffmanUtils({ ...LENGTH_TO_HUFFMAN_CODE });\n\n/**\n * 补全length\n */\nlet current: any;\nfor (let i = MAX_LENGTH; i >= 1; i--) {\n  if (i in LENGTH_TO_HUFFMAN_CODE) current = LENGTH_TO_HUFFMAN_CODE[i];\n  else LENGTH_TO_HUFFMAN_CODE[i] = current;\n}\n\nfunction getLength(v: number) {\n  return (Math.log2(v) | 0) + 1;\n}\n\nexport function decodeNumbers(str: string): number[] {\n  const results: number[] = [];\n  const len = str.length;\n  const indexRef = {\n    current: 0,\n  };\n  while (indexRef.current < len) {\n    const numLength = parseInt(lengthHuffmanUtils.decodeOnce(str, indexRef));\n    results.push(parseInt(str.slice(indexRef.current, indexRef.current + numLength), 2));\n    indexRef.current += numLength;\n  }\n  return results;\n}\n\nexport function encodeNumbers(numbers: number[]) {\n  return numbers\n    .map((v) => {\n      const len = getLength(v);\n      if (len in LENGTH_TO_HUFFMAN_CODE) {\n        const code = LENGTH_TO_HUFFMAN_CODE[len];\n        const matchLen = HUFFMAN_CODE_TO_LENGTH[code];\n        return code + padStart(v.toString(2), matchLen, '0');\n      }\n      throw new Error(`cannot find key \"${len}\" in map`);\n    })\n    .join('');\n}\n","/**\n * 将日期按照顺序差分成日期数据数组进行压缩\n */\nimport { decodeNumbers, encodeNumbers } from './compressDateNumbers';\n\nconst START_DATE = 1600120800;\n/**\n * 解密\n */\nexport function decodeDate(str: string): number[] {\n  const numbers = decodeNumbers(str);\n  const dates: number[] = [];\n  let currentDate = START_DATE;\n  for (let i = 0, len = numbers.length; i < len; i++) {\n    currentDate += numbers[i];\n    dates.push(currentDate);\n  }\n  return dates.map((v) => 1000 * v);\n}\n\n/**\n * 加密\n */\nexport function encodeDate(_dates: number[]) {\n  const dates = _dates.map((date) => date / 1000);\n  const dDates = [dates[0] - START_DATE].concat(dates.slice(1).map((v, index) => v - dates[index]));\n  return encodeNumbers(dDates);\n}\n","import flatten from 'lodash/flatten';\nimport sortBy from 'lodash/sortBy';\nimport { DataItem } from 'types';\nimport { ExcelParsedObject } from 'utils/parseExcel';\nimport { decodeDataItem, encodeDataItem } from './compressDataItem';\nimport { decodeDate, encodeDate } from './compressDate';\nimport { createHuffmanUtils } from './huffman';\nimport {\n  compressBinaryToEncodedURIComponent,\n  decompressBinaryFromEncodedURIComponent,\n} from './utils';\n\n/**\n * 控制字符包括 设定抽的池子，\n */\nenum ControlAction {\n  matchOne = '0', // 单抽 或者 十连\n  matchTen = '1',\n  changePool = '2', // 换池子\n}\n\nconst ControlActionMap = {\n  [ControlAction.matchOne]: '1',\n  [ControlAction.matchTen]: '01',\n  [ControlAction.changePool]: '001',\n};\n\nconst controlActionUtils = createHuffmanUtils(ControlActionMap);\n\nconst PoolTypeMap = {\n  character: '11',\n  weapon: '101',\n  novice: '100',\n  permanent: '0',\n} as any;\nconst poolTypeUtils = createHuffmanUtils(PoolTypeMap);\n\nconst SEPARATOR = ':'; // 压缩时没用到的字符\nconst VERSION = 1;\n\nfunction encodeChangePool(poolType: string) {\n  return (\n    controlActionUtils.encodeOnce(ControlAction.changePool) + poolTypeUtils.encodeOnce(poolType)\n  );\n}\n\nexport function encode(data: ExcelParsedObject) {\n  console.log('encode');\n\n  const allDataItem = sortBy(flatten(Object.values(data)), (item) => item.date);\n\n  const dates = [];\n  const dataStrArr = [];\n  let currentPool = '';\n  function walk(item: DataItem) {\n    dataStrArr.push(encodeDataItem(item));\n  }\n  for (let i = 0, len = allDataItem.length; i < len; ) {\n    const current = allDataItem[i];\n    if (current.poolType !== currentPool) {\n      currentPool = current.poolType;\n      dataStrArr.push(encodeChangePool(currentPool));\n    }\n    dates.push(current.date);\n\n    if (i < len - 1 && allDataItem[i + 1].date === current.date) {\n      dataStrArr.push(controlActionUtils.encodeOnce(ControlAction.matchTen));\n      allDataItem.slice(i, i + 10).forEach(walk);\n      i = i + 10;\n    } else {\n      dataStrArr.push(controlActionUtils.encodeOnce(ControlAction.matchOne));\n      walk(current);\n      i++;\n    }\n  }\n  const encodedDateStr = encodeDate(dates);\n\n  return (\n    compressBinaryToEncodedURIComponent(encodedDateStr) +\n    SEPARATOR +\n    compressBinaryToEncodedURIComponent(dataStrArr.join('')) +\n    SEPARATOR +\n    VERSION\n  );\n}\n\nexport function decode(str: string): ExcelParsedObject {\n  console.log('decode');\n\n  const splitSegs = str.split(SEPARATOR);\n  const [_encodedDateStr, encodedDataStr] = splitSegs\n    .slice(0, 2)\n    .map(decompressBinaryFromEncodedURIComponent);\n  const dates = decodeDate(_encodedDateStr);\n\n  const data = {\n    character: [],\n    weapon: [],\n    novice: [],\n    permanent: [],\n  } as any;\n\n  const indexRef = {\n    current: 0,\n  };\n  const len = encodedDataStr.length;\n  let currentPool = '';\n  while (indexRef.current < len) {\n    let action = controlActionUtils.decodeOnce(encodedDataStr, indexRef);\n    if (action === ControlAction.matchOne) {\n      const item = decodeDataItem(encodedDataStr, indexRef);\n      item.date = dates.shift();\n      data[currentPool].push(item);\n    } else if (action === ControlAction.matchTen) {\n      const date = dates.shift();\n      for (let i = 0; i < 10; i++) {\n        const item = decodeDataItem(encodedDataStr, indexRef);\n        item.date = date;\n        data[currentPool].push(item);\n      }\n    } else if (action === ControlAction.changePool) {\n      currentPool = poolTypeUtils.decodeOnce(encodedDataStr, indexRef);\n    } else {\n      throw new Error('unmatched action');\n    }\n  }\n  if (dates.length !== 0) {\n    // 十连的时间其实可能并不完全相同，这时有可能造成时间匹配错位？\n    console.log(dates);\n    console.error(new Error('dates match error'));\n    // throw new Error('dates match error');\n  }\n  return data;\n}\n","/**\n * 进行压缩\n */\nimport { POOL_TYPE_TO_NAME } from 'const';\nimport flatten from 'lodash/flatten';\nimport sortBy from 'lodash/sortBy';\nimport { ExcelParsedObject } from './parseExcel';\nimport { decode, encode } from './v1';\nimport { padStart } from './v1/utils';\n\nexport function compressToHash(data: ExcelParsedObject) {\n  try {\n    const hash = encode(data);\n    const location = window.location;\n    const newurl = `${location.protocol}//${location.host}${location.pathname}#${hash}`;\n    window.history.replaceState(\n      {\n        path: newurl,\n      },\n      '',\n      newurl,\n    );\n  } catch (e) {\n    console.error(e);\n    window.location.hash = '';\n  }\n}\n\nconst pad2 = (s: string | number) => padStart('' + s, 2, '0');\nfunction formatToDate(dateNum: number) {\n  const date = new Date(dateNum);\n  return `${date.getFullYear()}-${pad2(date.getMonth() + 1)}-${pad2(date.getDate())} ${pad2(\n    date.getHours(),\n  )}:${pad2(date.getMinutes())}:${pad2(date.getSeconds())}`;\n}\n\nexport function decompressFromHash() {\n  try {\n    const location = window.location;\n    if (location.hash) {\n      const hash = location.hash.slice(1);\n      const data = decode(hash);\n\n      sortBy(flatten(Object.values(data)), (item) => item.date).forEach(\n        (item, index) => (item.总次数 = index + 1),\n      );\n\n      Object.keys(data).forEach((poolType: string) => {\n        let count = 1;\n        data[poolType as keyof ExcelParsedObject].forEach((item) => {\n          item.时间 = formatToDate(item.date);\n          item.pool = (POOL_TYPE_TO_NAME as any)[poolType];\n          item.保底内 = count++;\n          if (item.星级 === 5) count = 1;\n        });\n      });\n      return data;\n    }\n  } catch (e) {\n    console.error(e);\n    throw e;\n  }\n}\n"],"sourceRoot":""}